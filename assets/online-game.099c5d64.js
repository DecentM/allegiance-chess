import{Q as c}from"./chess-piece.c5cfb6c7.js";import{b as _,a as i}from"./QList.303bedc2.js";import{A as b,o as x,a as k,r as y,k as w,w as I,B as v,C as m,D as a,G as t,N as o,H as d,I as C,u as q,P as B}from"./index.484eb10a.js";import{u as N}from"./use-quasar.39ef162e.js";import{u as Q,_ as S,C as M,G as O,a as G}from"./board-worker.6987b155.js";import"./use-dark.46db6b1f.js";import"./QCard.6aed58f5.js";import"./QScrollObserver.81a14f69.js";import"./focus-manager.202af5b7.js";import"./QSeparator.781799b9.js";import"./notify.27e3d8d4.js";import"./exports.e29b12a1.js";const j=b({__name:"online-game",props:{connection:{}},setup(p){const n=p;x(()=>{n.connection.disconnect()});const f=N(),l=k(()=>n.connection.serverSide.value?n.connection.isHost.value?n.connection.serverSide.value:n.connection.serverSide.value==="white"?"black":"white":null),g=y([]),e=Q({autoplayFor:g});w(()=>e.reset());const h=r=>{n.connection.sendMessage({type:"execute-node-index",value:r})};return I(n.connection.moveHistory,r=>{const u=r[r.length-1];typeof u=="number"&&e.executeMoveIndex(u)}),(r,u)=>(v(),m(S,null,{board:a(()=>{var s;return[t(M,{onExecuteNodeIndex:h,"model-value":o(e).afen.value,"valid-moves":o(e).validMoves.value,board:o(e),perspective:(s=l.value)!=null?s:"white","play-as":["white","black"],"rounded-borders":o(f).screen.gt.xs,"active-colour":o(e).activeColour.value,"check-moves":o(e).checkMoves.value,"en-passant-target":o(e).enPassantTarget.value,"move-history-ast":o(e).moveHistoryAst.value,squares:o(e).squares.value,loading:o(e).loading.value},null,8,["model-value","valid-moves","board","perspective","rounded-borders","active-colour","check-moves","en-passant-target","move-history-ast","squares","loading"])]}),sidebar:a(()=>{var s;return[t(O,{"move-history":o(e).moveHistoryAst.value,"active-colour":o(e).activeColour.value,"own-colour":(s=l.value)!=null?s:"white",afen:o(e).afen.value,"game-over":o(e).gameOver.value},{default:a(()=>[t(_,null,{default:a(()=>[t(i,{class:"q-mt-sm q-mb-sm"},{default:a(()=>[t(c,null,{default:a(()=>[d("Opening")]),_:1}),t(c,{caption:"",lines:"2"},{default:a(()=>[d(C(o(e).opening.value||"unknown"),1)]),_:1})]),_:1}),t(i,{side:""},{default:a(()=>[t(q,{name:"book"})]),_:1})]),_:1})]),_:1},8,["move-history","active-colour","own-colour","afen","game-over"])]}),default:a(()=>[o(e).gameOver.value?(v(),m(G,{key:0,node:o(e).gameOver.value},null,8,["node"])):B("",!0)]),_:1}))}});export{j as default};
//# sourceMappingURL=online-game.099c5d64.js.map
