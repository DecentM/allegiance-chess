import{Q as H,a as h}from"./QCard.f7f5f7ac.js";import{c as E,ax as O,ay as j,a as i,E as D,j as P,h as v,T as x,az as F,aA as G,s as L,M as V,N as d,O as b,P as s,S as c,aa as C,Q as k,R as U,U as B,V as N,$ as z,a0 as A,W as K,aB as W,_ as X,af as Y,ag as J,ac as T,X as Z,aj as ee,ae as te}from"./index.7ca902b9.js";import{G as ae,p as oe,t as re,w as se,b as le,B as ie}from"./board.71748d9d.js";import{_ as ne}from"./chess-board.8c6164af.js";import{u as ce,a as ue}from"./use-dark.242c33f8.js";import{H as y}from"./hex.b74e8084.js";import{F as de}from"./boards.07b20eb6.js";import{u as me}from"./use-quasar.a9a6d843.js";import"./QList.afd901b9.js";import"./selection.9f6dca62.js";import"./focus-manager.202af5b7.js";import"./chess-piece.6cc51490.js";var I=Object.freeze(Object.defineProperty({__proto__:null,GameOutcome:ae,parse:oe,tokenize:re,writeNode:se,write:le},Symbol.toStringTag,{value:"Module"}));const ve={xs:8,sm:10,md:14,lg:20,xl:24};var R=E({name:"QChip",props:{...ce,...O,dense:Boolean,icon:String,iconRight:String,iconRemove:String,iconSelected:String,label:[String,Number],color:String,textColor:String,modelValue:{type:Boolean,default:!0},selected:{type:Boolean,default:null},square:Boolean,outline:Boolean,clickable:Boolean,removable:Boolean,removeAriaLabel:String,tabindex:[String,Number],disable:Boolean,ripple:{type:[Boolean,Object],default:!0}},emits:["update:modelValue","update:selected","remove","click"],setup(e,{slots:n,emit:u}){const{proxy:{$q:r}}=P(),m=ue(e,r),a=j(e,ve),f=i(()=>e.selected===!0||e.icon!==void 0),l=i(()=>e.selected===!0?e.iconSelected||r.iconSet.chip.selected:e.icon),p=i(()=>e.iconRemove||r.iconSet.chip.remove),o=i(()=>e.disable===!1&&(e.clickable===!0||e.selected!==null)),_=i(()=>{const t=e.outline===!0&&e.color||e.textColor;return"q-chip row inline no-wrap items-center"+(e.outline===!1&&e.color!==void 0?` bg-${e.color}`:"")+(t?` text-${t} q-chip--colored`:"")+(e.disable===!0?" disabled":"")+(e.dense===!0?" q-chip--dense":"")+(e.outline===!0?" q-chip--outline":"")+(e.selected===!0?" q-chip--selected":"")+(o.value===!0?" q-chip--clickable cursor-pointer non-selectable q-hoverable":"")+(e.square===!0?" q-chip--square":"")+(m.value===!0?" q-chip--dark q-dark":"")}),q=i(()=>{const t=e.disable===!0?{tabindex:-1,"aria-disabled":"true"}:{tabindex:e.tabindex||0},g={...t,role:"button","aria-hidden":"false","aria-label":e.removeAriaLabel||r.lang.label.remove};return{chip:t,remove:g}});function M(t){t.keyCode===13&&S(t)}function S(t){e.disable||(u("update:selected",!e.selected),u("click",t))}function w(t){(t.keyCode===void 0||t.keyCode===13)&&(L(t),e.disable===!1&&(u("update:modelValue",!1),u("remove")))}function Q(){const t=[];o.value===!0&&t.push(v("div",{class:"q-focus-helper"})),f.value===!0&&t.push(v(x,{class:"q-chip__icon q-chip__icon--left",name:l.value}));const g=e.label!==void 0?[v("div",{class:"ellipsis"},[e.label])]:void 0;return t.push(v("div",{class:"q-chip__content col row no-wrap items-center q-anchor--skip"},F(n.default,g))),e.iconRight&&t.push(v(x,{class:"q-chip__icon q-chip__icon--right",name:e.iconRight})),e.removable===!0&&t.push(v(x,{class:"q-chip__icon q-chip__icon--remove cursor-pointer",name:p.value,...q.value.remove,onClick:w,onKeyup:w})),t}return()=>{if(e.modelValue===!1)return;const t={class:_.value,style:a.value};return o.value===!0&&Object.assign(t,q.value.chip,{onClick:S,onKeyup:M}),D("div",t,Q(),"ripple",e.ripple!==!1&&e.disable!==!0,()=>[[G,e.ripple]])}}});const $=e=>(Y("data-v-96ea3886"),e=e(),J(),e),he=$(()=>T("div",{class:"text-h6"},"Your turn!",-1)),fe=$(()=>T("div",{class:"text-h6"},"Waiting for opponent...",-1)),_e={key:0,class:"col"},be={key:0,class:"col"},pe=V({__name:"game-sidebar",props:{moveHistory:{},activeColour:{},ownColour:{}},setup(e){const n=e,u=i(()=>{const r=[];return n.moveHistory.children.forEach(m=>{const a=r.at(-1);if(!a||a.length!==1){r.push([m]);return}a.push(m)}),r});return(r,m)=>(d(),b(H,{flat:"",bordered:"",class:"q-ma-md"},{default:s(()=>[c(C,{mode:"out-in"},{default:s(()=>[r.activeColour===r.ownColour?(d(),b(h,{key:0,class:"bg-primary text-white q-mb-md"},{default:s(()=>[he]),_:1})):(d(),b(h,{key:1,class:"bg-grey text-black q-mb-md"},{default:s(()=>[fe]),_:1}))]),_:1}),c(W,{mode:"out-in"},{default:s(()=>[(d(!0),k(K,null,U(u.value,(a,f)=>(d(),b(h,{key:f,horizontal:"",class:"row q-py-none q-mx-md"},{default:s(()=>[a[0]?(d(),k("div",_e,[c(R,{class:"white-move"},{default:s(()=>[B(N(z(I).writeNode(a[0])),1)]),_:2},1024)])):A("",!0),c(C,{mode:"out-in"},{default:s(()=>[a[1]?(d(),k("div",be,[c(R,{class:"black-move"},{default:s(()=>[B(N(z(I).writeNode(a[1])),1)]),_:2},1024)])):A("",!0)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}))}});var ye=X(pe,[["__scopeId","data-v-96ea3886"]]);const Re=V({__name:"pen-pal-game",setup(e){const n=Z(),u=ee(),r=i(()=>{const o=Array.isArray(n.params.state)?n.params.state[0]:n.params.state;return o?y.hexToUtf8(o):de.VanillaDefault}),m=i(()=>{const o=Array.isArray(n.params.history)?n.params.history[0]:n.params.history;return o?y.hexToUtf8(o):""}),a=i(()=>{const o=new ie;return o.importAFEN(r.value),o.importMoveHistory(m.value),o}),f=o=>{const _=a.value.findMoveIndex(o);_!==-1&&(a.value.executeMoveIndex(_),u.push({path:`/play/pen-pal/${y.utf8ToHex(a.value.toAFEN())}/${y.utf8ToHex(a.value.getMoveHistory())}`}))},l=me(),p=i(()=>l.screen.gt.lg?l.screen.sizes.lg:l.screen.gt.md?l.screen.sizes.md:l.screen.gt.sm?l.screen.sizes.sm:l.screen.gt.xs?l.screen.width/2:l.screen.width/3);return(o,_)=>(d(),b(H,{flat:"",class:"full-width"},{default:s(()=>[c(h,{horizontal:""},{default:s(()=>[c(h,{style:te({width:`${p.value}px`})},{default:s(()=>[c(ne,{onExecuteNode:f,board:a.value,perspective:a.value.activeColour,"play-as":["white","black"],width:p.value},null,8,["board","perspective","width"])]),_:1},8,["style"]),c(h,{class:"q-mb-md full-width"},{default:s(()=>[c(ye,{"move-history":a.value.getMoveHistoryAst(),"active-colour":a.value.activeColour,"own-colour":a.value.activeColour},null,8,["move-history","active-colour","own-colour"])]),_:1})]),_:1})]),_:1}))}});export{Re as default};
