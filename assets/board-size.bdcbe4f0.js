import{p as Vt,t as Nt,w as Kt,a as Gt,f as Ut,c as V,i as Le,b as Yt,P as Je}from"./board.dd871857.js";import{u as Fe}from"./use-quasar.54281f3f.js";import{A as I,B as h,E as M,J,F as Z,_ as ue,N as le,M as A,I as ve,O as L,r as P,ac as Ne,a6 as Ze,n as _t,a4 as Ie,w as U,k as yt,o as pe,j as ge,a9 as Xt,S as Re,au as $e,z as Jt,ao as Zt,h as E,av as It,aw as el,ax as tl,a as p,$ as St,a0 as ll,X as Ke,c as ke,a8 as ol,e as Ge,ad as _e,ay as kt,Y as zt,C as D,D as x,G as w,u as ie,m as ye,az as Ue,aj as Me,af as N,aA as al,aB as il,p as nl,aC as sl,an as rl,aq as ul,s as cl,ah as dl,H as qe,as as vl,at as fl,aD as hl,aE as ml,a2 as pl,Q as et}from"./index.27347ab9.js";import{b as Pe,a as Se,Q as qt}from"./QList.86fd8f90.js";import{i as gl,g as bl,u as wt,a as Ct,b as $t,c as xt,j as _l,e as we,Q as tt,h as yl,s as lt,k as Oe,T as ot,d as Sl,f as kl}from"./QScrollObserver.b4b72023.js";import{u as Ye,a as Xe}from"./use-dark.3830ce2f.js";import{b as at,c as zl,a as Mt}from"./focus-manager.202af5b7.js";import{C as he,Q as it}from"./chess-piece.e3fcb840.js";import{Q as Pt,a as ae,b as xe}from"./QCard.3ab89c0f.js";const ql={White:"white",Black:"black",Draw:"draw",Forfeit:"forfeit",ForfeitWhite:"forfeit-white",ForfeitBlack:"forfeit-black"};var nt=Object.freeze(Object.defineProperty({__proto__:null,GameOutcome:ql,parse:Vt,tokenize:Nt,writeNode:Kt,write:Gt},Symbol.toStringTag,{value:"Module"}));const wl={class:"row column full-width full-height no-pointer-events background-layer","data-testid":"background"},Cl={key:0,class:"absolute absolute-bottom-right q-px-sm"},$l={key:1,class:"absolute absolute-top-left q-pa-xs"},xl=I({__name:"background-layer",props:{ranks:{},files:{},perspective:{}},setup(e){const l=Fe();return(t,a)=>(h(),M("div",wl,[(h(!0),M(J,null,Z(t.ranks,(n,r)=>(h(),M("div",{class:"rank col row full-width",key:r},[(h(!0),M(J,null,Z(t.files,(i,o)=>(h(),M("div",{key:o,class:le(["file col relative-position",{"text-h6 text-bold":A(l).screen.gt.sm,"text-subtitle1 text-bold":A(l).screen.sm,"text-subtitle2":A(l).screen.lt.sm}])},[r===7?(h(),M("span",Cl,ve(A(Ut)(t.perspective==="white"?9-(8-o):8-o)),1)):L("",!0),o===0?(h(),M("span",$l,ve(t.perspective==="white"?8-r:9-(8-r)),1)):L("",!0)],2))),128))]))),128))]))}});var Ml=ue(xl,[["__scopeId","data-v-5503eeb2"]]);const Pl={target:{default:!0},noParentEvent:Boolean,contextMenu:Boolean};function El({showing:e,avoidEmit:l,configureAnchorEl:t}){const{props:a,proxy:n,emit:r}=ge(),i=P(null);let o=null;function s(u){return i.value===null?!1:u===void 0||u.touches===void 0||u.touches.length<=1}const d={};t===void 0&&(Object.assign(d,{hide(u){n.hide(u)},toggle(u){n.toggle(u),u.qAnchorHandled=!0},toggleKey(u){Ne(u,13)===!0&&d.toggle(u)},contextClick(u){n.hide(u),Ze(u),_t(()=>{n.show(u),u.qAnchorHandled=!0})},prevent:Ze,mobileTouch(u){if(d.mobileCleanup(u),s(u)!==!0)return;n.hide(u),i.value.classList.add("non-selectable");const b=u.target;Ie(d,"anchor",[[b,"touchmove","mobileCleanup","passive"],[b,"touchend","mobileCleanup","passive"],[b,"touchcancel","mobileCleanup","passive"],[i.value,"contextmenu","prevent","notPassive"]]),o=setTimeout(()=>{o=null,n.show(u),u.qAnchorHandled=!0},300)},mobileCleanup(u){i.value.classList.remove("non-selectable"),o!==null&&(clearTimeout(o),o=null),e.value===!0&&u!==void 0&&gl()}}),t=function(u=a.contextMenu){if(a.noParentEvent===!0||i.value===null)return;let b;u===!0?n.$q.platform.is.mobile===!0?b=[[i.value,"touchstart","mobileTouch","passive"]]:b=[[i.value,"mousedown","hide","passive"],[i.value,"contextmenu","contextClick","notPassive"]]:b=[[i.value,"click","toggle","passive"],[i.value,"keyup","toggleKey","passive"]],Ie(d,"anchor",b)});function m(){Xt(d,"anchor")}function y(u){for(i.value=u;i.value.classList.contains("q-anchor--skip");)i.value=i.value.parentNode;t()}function $(){if(a.target===!1||a.target===""||n.$el.parentNode===null)i.value=null;else if(a.target===!0)y(n.$el.parentNode);else{let u=a.target;if(typeof a.target=="string")try{u=document.querySelector(a.target)}catch{u=void 0}u!=null?(i.value=u.$el||u,t()):(i.value=null,console.error(`Anchor: target "${a.target}" not found`))}}return U(()=>a.contextMenu,u=>{i.value!==null&&(m(),t(u))}),U(()=>a.target,()=>{i.value!==null&&m(),$()}),U(()=>a.noParentEvent,u=>{i.value!==null&&(u===!0?m():t())}),yt(()=>{$(),l!==!0&&a.modelValue===!0&&i.value===null&&r("update:modelValue",!1)}),pe(()=>{o!==null&&clearTimeout(o),m()}),{anchorEl:i,canShow:s,anchorEvents:d}}function Tl(e,l){const t=P(null);let a;function n(o,s){const d=`${s!==void 0?"add":"remove"}EventListener`,m=s!==void 0?s:a;o!==window&&o[d]("scroll",m,Re.passive),window[d]("scroll",m,Re.passive),a=s}function r(){t.value!==null&&(n(t.value),t.value=null)}const i=U(()=>e.noParentEvent,()=>{t.value!==null&&(r(),l())});return pe(i),{localScrollTarget:t,unconfigureScrollTarget:r,changeScrollEvent:n}}const fe=[];function Bl(e){return fe.find(l=>l.contentEl!==null&&l.contentEl.contains(e))}function Et(e,l){do{if(e.$options.name==="QMenu"){if(e.hide(l),e.$props.separateClosePopup===!0)return $e(e)}else if(e.__qPortal===!0){const t=$e(e);return t!==void 0&&t.$options.name==="QPopupProxy"?(e.hide(l),t):e}e=$e(e)}while(e!=null)}function Fl(e,l,t){for(;t!==0&&e!==void 0&&e!==null;){if(e.__qPortal===!0){if(t--,e.$options.name==="QMenu"){e=Et(e,l);continue}e.hide(l)}e=$e(e)}}function Hl(e){for(e=e.parent;e!=null;){if(e.type.name==="QGlobalDialog")return!0;if(e.type.name==="QDialog"||e.type.name==="QMenu")return!1;e=e.parent}return!1}function Tt(e,l,t,a){const n=P(!1),r=P(!1);let i=null;const o={},s=a==="dialog"&&Hl(e);function d(y){if(y===!0){at(o),r.value=!0;return}r.value=!1,n.value===!1&&(s===!1&&i===null&&(i=el(!1,a)),n.value=!0,fe.push(e.proxy),zl(o))}function m(y){if(r.value=!1,y!==!0)return;at(o),n.value=!1;const $=fe.indexOf(e.proxy);$!==-1&&fe.splice($,1),i!==null&&(tl(i),i=null)}return Jt(()=>{m(!0)}),e.proxy.__qPortal=!0,Zt(e.proxy,"contentEl",()=>l.value),{showPortal:d,hidePortal:m,portalIsActive:n,portalIsAccessible:r,renderPortal:()=>s===!0?t():n.value===!0?[E(It,{to:i},t())]:void 0}}const Bt={transitionShow:{type:String,default:"fade"},transitionHide:{type:String,default:"fade"},transitionDuration:{type:[String,Number],default:300}};function Ft(e,l=()=>{},t=()=>{}){return{transitionProps:p(()=>{const a=`q-transition--${e.transitionShow||l()}`,n=`q-transition--${e.transitionHide||t()}`;return{appear:!0,enterFromClass:`${a}-enter-from`,enterActiveClass:`${a}-enter-active`,enterToClass:`${a}-enter-to`,leaveFromClass:`${n}-leave-from`,leaveActiveClass:`${n}-leave-active`,leaveToClass:`${n}-leave-to`}}),transitionStyle:p(()=>`--q-transition-duration: ${e.transitionDuration}ms`)}}function Ht(){let e;const l=ge();function t(){e=void 0}return St(t),pe(t),{removeTick:t,registerTick(a){e=a,_t(()=>{e===a&&(ll(l)===!1&&e(),e=void 0)})}}}const ne=[];let me;function Al(e){me=e.keyCode===27}function Dl(){me===!0&&(me=!1)}function Ll(e){me===!0&&(me=!1,Ne(e,27)===!0&&ne[ne.length-1](e))}function At(e){window[e]("keydown",Al),window[e]("blur",Dl),window[e]("keyup",Ll),me=!1}function Dt(e){Ke.is.desktop===!0&&(ne.push(e),ne.length===1&&At("addEventListener"))}function Ee(e){const l=ne.indexOf(e);l>-1&&(ne.splice(l,1),ne.length===0&&At("removeEventListener"))}const se=[];function Lt(e){se[se.length-1](e)}function Ot(e){Ke.is.desktop===!0&&(se.push(e),se.length===1&&document.body.addEventListener("focusin",Lt))}function je(e){const l=se.indexOf(e);l>-1&&(se.splice(l,1),se.length===0&&document.body.removeEventListener("focusin",Lt))}const{notPassiveCapture:Te}=Re,re=[];function Be(e){const l=e.target;if(l===void 0||l.nodeType===8||l.classList.contains("no-pointer-events")===!0)return;let t=fe.length-1;for(;t>=0;){const a=fe[t].$;if(a.type.name==="QTooltip"){t--;continue}if(a.type.name!=="QDialog")break;if(a.props.seamless!==!0)return;t--}for(let a=re.length-1;a>=0;a--){const n=re[a];if((n.anchorEl.value===null||n.anchorEl.value.contains(l)===!1)&&(l===document.body||n.innerRef.value!==null&&n.innerRef.value.contains(l)===!1))e.qClickOutside=!0,n.onClickOutside(e);else return}}function Ol(e){re.push(e),re.length===1&&(document.addEventListener("mousedown",Be,Te),document.addEventListener("touchstart",Be,Te))}function st(e){const l=re.findIndex(t=>t===e);l>-1&&(re.splice(l,1),re.length===0&&(document.removeEventListener("mousedown",Be,Te),document.removeEventListener("touchstart",Be,Te)))}let rt,ut;function ct(e){const l=e.split(" ");return l.length!==2?!1:["top","center","bottom"].includes(l[0])!==!0?(console.error("Anchor/Self position must start with one of top/center/bottom"),!1):["left","middle","right","start","end"].includes(l[1])!==!0?(console.error("Anchor/Self position must end with one of left/middle/right/start/end"),!1):!0}function Ql(e){return e?!(e.length!==2||typeof e[0]!="number"||typeof e[1]!="number"):!0}const Ve={"start#ltr":"left","start#rtl":"right","end#ltr":"right","end#rtl":"left"};["left","middle","right"].forEach(e=>{Ve[`${e}#ltr`]=e,Ve[`${e}#rtl`]=e});function dt(e,l){const t=e.split(" ");return{vertical:t[0],horizontal:Ve[`${t[1]}#${l===!0?"rtl":"ltr"}`]}}function Wl(e,l){let{top:t,left:a,right:n,bottom:r,width:i,height:o}=e.getBoundingClientRect();return l!==void 0&&(t-=l[1],a-=l[0],r+=l[1],n+=l[0],i+=l[0],o+=l[1]),{top:t,bottom:r,height:o,left:a,right:n,width:i,middle:a+(n-a)/2,center:t+(r-t)/2}}function Rl(e,l,t){let{top:a,left:n}=e.getBoundingClientRect();return a+=l.top,n+=l.left,t!==void 0&&(a+=t[1],n+=t[0]),{top:a,bottom:a+1,height:1,left:n,right:n+1,width:1,middle:n,center:a}}function jl(e,l){return{top:0,center:l/2,bottom:l,left:0,middle:e/2,right:e}}function vt(e,l,t,a){return{top:e[t.vertical]-l[a.vertical],left:e[t.horizontal]-l[a.horizontal]}}function Qt(e,l=0){if(e.targetEl===null||e.anchorEl===null||l>5)return;if(e.targetEl.offsetHeight===0||e.targetEl.offsetWidth===0){setTimeout(()=>{Qt(e,l+1)},10);return}const{targetEl:t,offset:a,anchorEl:n,anchorOrigin:r,selfOrigin:i,absoluteOffset:o,fit:s,cover:d,maxHeight:m,maxWidth:y}=e;if(Ke.is.ios===!0&&window.visualViewport!==void 0){const T=document.body.style,{offsetLeft:g,offsetTop:B}=window.visualViewport;g!==rt&&(T.setProperty("--q-pe-left",g+"px"),rt=g),B!==ut&&(T.setProperty("--q-pe-top",B+"px"),ut=B)}const{scrollLeft:$,scrollTop:u}=t,b=o===void 0?Wl(n,d===!0?[0,0]:a):Rl(n,o,a);Object.assign(t.style,{top:0,left:0,minWidth:null,minHeight:null,maxWidth:y||"100vw",maxHeight:m||"100vh",visibility:"visible"});const{offsetWidth:Q,offsetHeight:f}=t,{elWidth:O,elHeight:j}=s===!0||d===!0?{elWidth:Math.max(b.width,Q),elHeight:d===!0?Math.max(b.height,f):f}:{elWidth:Q,elHeight:f};let F={maxWidth:y,maxHeight:m};(s===!0||d===!0)&&(F.minWidth=b.width+"px",d===!0&&(F.minHeight=b.height+"px")),Object.assign(t.style,F);const v=jl(O,j);let S=vt(b,v,r,i);if(o===void 0||a===void 0)Qe(S,b,v,r,i);else{const{top:T,left:g}=S;Qe(S,b,v,r,i);let B=!1;if(S.top!==T){B=!0;const z=2*a[1];b.center=b.top-=z,b.bottom-=z+2}if(S.left!==g){B=!0;const z=2*a[0];b.middle=b.left-=z,b.right-=z+2}B===!0&&(S=vt(b,v,r,i),Qe(S,b,v,r,i))}F={top:S.top+"px",left:S.left+"px"},S.maxHeight!==void 0&&(F.maxHeight=S.maxHeight+"px",b.height>S.maxHeight&&(F.minHeight=F.maxHeight)),S.maxWidth!==void 0&&(F.maxWidth=S.maxWidth+"px",b.width>S.maxWidth&&(F.minWidth=F.maxWidth)),Object.assign(t.style,F),t.scrollTop!==u&&(t.scrollTop=u),t.scrollLeft!==$&&(t.scrollLeft=$)}function Qe(e,l,t,a,n){const r=t.bottom,i=t.right,o=bl(),s=window.innerHeight-o,d=document.body.clientWidth;if(e.top<0||e.top+r>s)if(n.vertical==="center")e.top=l[a.vertical]>s/2?Math.max(0,s-r):0,e.maxHeight=Math.min(r,s);else if(l[a.vertical]>s/2){const m=Math.min(s,a.vertical==="center"?l.center:a.vertical===n.vertical?l.bottom:l.top);e.maxHeight=Math.min(r,m),e.top=Math.max(0,m-r)}else e.top=Math.max(0,a.vertical==="center"?l.center:a.vertical===n.vertical?l.top:l.bottom),e.maxHeight=Math.min(r,s-e.top);if(e.left<0||e.left+i>d)if(e.maxWidth=Math.min(i,d),n.horizontal==="middle")e.left=l[a.horizontal]>d/2?Math.max(0,d-i):0;else if(l[a.horizontal]>d/2){const m=Math.min(d,a.horizontal==="middle"?l.middle:a.horizontal===n.horizontal?l.right:l.left);e.maxWidth=Math.min(i,m),e.left=Math.max(0,m-e.maxWidth)}else e.left=Math.max(0,a.horizontal==="middle"?l.middle:a.horizontal===n.horizontal?l.left:l.right),e.maxWidth=Math.min(i,d-e.left)}var Wt=ke({name:"QMenu",inheritAttrs:!1,props:{...Pl,...wt,...Ye,...Bt,persistent:Boolean,autoClose:Boolean,separateClosePopup:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,fit:Boolean,cover:Boolean,square:Boolean,anchor:{type:String,validator:ct},self:{type:String,validator:ct},offset:{type:Array,validator:Ql},scrollTarget:{default:void 0},touchPosition:Boolean,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null}},emits:[...Ct,"click","escapeKey"],setup(e,{slots:l,emit:t,attrs:a}){let n=null,r,i,o;const s=ge(),{proxy:d}=s,{$q:m}=d,y=P(null),$=P(!1),u=p(()=>e.persistent!==!0&&e.noRouteDismiss!==!0),b=Xe(e,m),{registerTick:Q,removeTick:f}=Ht(),{registerTimeout:O}=$t(),{transitionProps:j,transitionStyle:F}=Ft(e),{localScrollTarget:v,changeScrollEvent:S,unconfigureScrollTarget:T}=Tl(e,te),{anchorEl:g,canShow:B}=El({showing:$}),{hide:z}=xt({showing:$,canShow:B,handleShow:G,handleHide:be,hideOnRouteChange:u,processOnMount:!0}),{showPortal:Y,hidePortal:W,renderPortal:K}=Tt(s,y,ze,"menu"),oe={anchorEl:g,innerRef:y,onClickOutside(k){if(e.persistent!==!0&&$.value===!0)return z(k),(k.type==="touchstart"||k.target.classList.contains("q-dialog__backdrop"))&&zt(k),!0}},ce=p(()=>dt(e.anchor||(e.cover===!0?"center middle":"bottom start"),m.lang.rtl)),ee=p(()=>e.cover===!0?ce.value:dt(e.self||"top start",m.lang.rtl)),c=p(()=>(e.square===!0?" q-menu--square":"")+(b.value===!0?" q-menu--dark q-dark":"")),_=p(()=>e.autoClose===!0?{onClick:Ae}:{}),C=p(()=>$.value===!0&&e.persistent!==!0);U(C,k=>{k===!0?(Dt(H),Ol(oe)):(Ee(H),st(oe))});function R(){Mt(()=>{let k=y.value;k&&k.contains(document.activeElement)!==!0&&(k=k.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||k.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||k.querySelector("[autofocus], [data-autofocus]")||k,k.focus({preventScroll:!0}))})}function G(k){if(n=e.noRefocus===!1?document.activeElement:null,Ot(q),Y(),te(),r=void 0,k!==void 0&&(e.touchPosition||e.contextMenu)){const De=ol(k);if(De.left!==void 0){const{top:Rt,left:jt}=g.value.getBoundingClientRect();r={left:De.left-jt,top:De.top-Rt}}}i===void 0&&(i=U(()=>m.screen.width+"|"+m.screen.height+"|"+e.self+"|"+e.anchor+"|"+m.lang.rtl,X)),e.noFocus!==!0&&document.activeElement.blur(),Q(()=>{X(),e.noFocus!==!0&&R()}),O(()=>{m.platform.is.ios===!0&&(o=e.autoClose,y.value.click()),X(),Y(!0),t("show",k)},e.transitionDuration)}function be(k){f(),W(),de(!0),n!==null&&(k===void 0||k.qClickOutside!==!0)&&(((k&&k.type.indexOf("key")===0?n.closest('[tabindex]:not([tabindex^="-"])'):void 0)||n).focus(),n=null),O(()=>{W(!0),t("hide",k)},e.transitionDuration)}function de(k){r=void 0,i!==void 0&&(i(),i=void 0),(k===!0||$.value===!0)&&(je(q),T(),st(oe),Ee(H)),k!==!0&&(n=null)}function te(){(g.value!==null||e.scrollTarget!==void 0)&&(v.value=_l(g.value,e.scrollTarget),S(v.value,X))}function Ae(k){o!==!0?(Et(d,k),t("click",k)):o=!1}function q(k){C.value===!0&&e.noFocus!==!0&&kt(y.value,k.target)!==!0&&R()}function H(k){t("escapeKey"),z(k)}function X(){Qt({targetEl:y.value,offset:e.offset,anchorEl:g.value,anchorOrigin:ce.value,selfOrigin:ee.value,absoluteOffset:r,fit:e.fit,cover:e.cover,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function ze(){return E(_e,j.value,()=>$.value===!0?E("div",{role:"menu",...a,ref:y,tabindex:-1,class:["q-menu q-position-engine scroll"+c.value,a.class],style:[a.style,F.value],..._.value},Ge(l.default)):null)}return pe(de),Object.assign(d,{focus:R,updatePosition:X}),K}});const Vl=I({__name:"promotion-selector",props:{modelValue:{type:Boolean},allegiance:{}},emits:["click","dismiss"],setup(e,{emit:l}){const t=["Q","N","R","B"],a=()=>{l("dismiss")};return(n,r)=>(h(),D(Wt,{cover:"","model-value":n.modelValue,"onUpdate:modelValue":a},{default:x(()=>[w(qt,null,{default:x(()=>[(h(),M(J,null,Z(t,i=>w(Pe,{clickable:"",key:i,class:"q-pa-sm",onClick:o=>l("click",i)},{default:x(()=>[w(Se,{class:"promotion-piece items-center"},{default:x(()=>[w(he,{allegiance:n.allegiance,piece:i,size:92},null,8,["allegiance","piece"])]),_:2},1024)]),_:2},1032,["onClick"])),64))]),_:1})]),_:1},8,["model-value"]))}});var Nl=ue(Vl,[["__scopeId","data-v-370c2c26"]]);const Kl=I({__name:"capture-selector",props:{modelValue:{type:Boolean},moves:{}},emits:["click","dismiss"],setup(e,{emit:l}){const t=()=>{l("dismiss")};return(a,n)=>(h(),D(Wt,{cover:"","model-value":a.modelValue,"onUpdate:modelValue":t},{default:x(()=>[w(qt,null,{default:x(()=>[a.moves.includes("x")?(h(),D(Pe,{key:0,clickable:"",onClick:n[0]||(n[0]=r=>l("click","capture")),class:"q-py-lg"},{default:x(()=>[w(Se,{class:"items-center"},{default:x(()=>[w(ie,{size:"72px",name:"close"})]),_:1})]),_:1})):L("",!0),a.moves.includes(">")?(h(),D(Pe,{key:1,clickable:"",onClick:n[1]||(n[1]=r=>l("click","challenge")),class:"q-py-lg"},{default:x(()=>[w(Se,{class:"items-center"},{default:x(()=>[w(ie,{size:"64px",name:"arrow_forward_ios"})]),_:1})]),_:1})):L("",!0)]),_:1})]),_:1},8,["model-value"]))}});const Gl={class:"relative-position full-width full-height interaction-layer"},Ul=["onClick"],Yl=I({__name:"interaction-layer",props:{board:{},squareSize:{},ranks:{},files:{},perspective:{},pieceFocus:{}},emits:["execute-node-index","update-piece-focus","update-highlights"],setup(e,{emit:l}){const t=e,a=P(null),n=p(()=>t.board.enPassantTarget),r=P(null),i=P(null),o=p(()=>t.pieceFocus?t.board.getSquare(t.pieceFocus):null),s=p(()=>t.pieceFocus?t.board.getValidMoves(t.pieceFocus).map(T=>T.kind!=="move"?null:T.to).filter(Boolean):[]),d=v=>{const S=t.board.getSquare(v);return S?Yt(S.allegiance)!==t.perspective:!1},m=v=>s.value.some(S=>S&&V(v,S)),y=(v,S)=>{var g,B;if(S.stopPropagation(),S.preventDefault(),m(v)&&t.pieceFocus&&o.value){if(n.value&&V(n.value,v))l("execute-node-index",t.board.findMoveIndex({kind:"move",type:"en-passant",from:t.pieceFocus,to:v})),l("update-piece-focus",null);else if(Le(v,t.board.activeColour)&&o&&o.value.piece===null){r.value=v;const z=t.board.getSquare(t.pieceFocus);i.value=(g=z==null?void 0:z.allegiance)!=null?g:null}else t.board.getSquare(v)?a.value=v:((B=o.value)==null?void 0:B.piece)==="K"&&Math.abs(t.pieceFocus.file-v.file)>1?l("execute-node-index",t.board.findMoveIndex({kind:"move",type:"castle",side:v.file===7?"king":"queen",from:t.pieceFocus,to:v})):l("execute-node-index",t.board.findMoveIndex({kind:"move",from:t.pieceFocus,to:v}));return}if(d(v))return;const T=t.board.getSquare(v);l("update-piece-focus",T?v:null)},$=(v,S)=>{if(!t.pieceFocus)return;r.value=null;const T=t.board.findMoveIndex({kind:"move",type:"promotion",from:t.pieceFocus,to:v,promotionTo:S});l("execute-node-index",T),l("update-piece-focus",null)},u=()=>{r.value=null,i.value=null},b=()=>{a.value=null},Q=v=>{if(!t.pieceFocus||!a.value)return;const S=t.board.findMoveIndex({kind:"move",type:v==="capture"?"capture":"allegiance",from:t.pieceFocus,to:a.value});l("execute-node-index",S),a.value=null,l("update-piece-focus",null)},f=(v,S)=>{const T=v+1,g=S+1;return t.perspective==="white"?{file:T,rank:9-g}:{file:9-T,rank:g}},O=v=>!t.board.getSquare(v),j=(v,S,T)=>t.board.getValidMoves().some(B=>B.kind==="move"&&V(B.to,T)&&V(B.from,S)&&B.type===v),F=p(()=>{const v=[];return!t.pieceFocus||!a.value||(j("allegiance",t.pieceFocus,a.value)&&v.push(">"),j("capture",t.pieceFocus,a.value)&&v.push("x")),v});return(v,S)=>(h(),M("div",Gl,[(h(!0),M(J,null,Z(v.ranks,(T,g)=>(h(),M("div",{class:"col column row full-width",key:g},[(h(!0),M(J,null,Z(v.files,(B,z)=>{var Y,W;return h(),M("div",{key:z,class:"full-height"},[ye((h(),M("div",{class:le(["absolute",{"cursor-pointer":!O(f(z,g))||m(f(z,g)),"cursor-not-allowed":d(f(z,g))&&!o.value}]),onClick:K=>y(f(z,g),K),style:Me(v.perspective==="white"?{width:`${v.squareSize}px`,height:`${v.squareSize}px`,left:`${(f(z,g).file-1)*v.squareSize}px`,bottom:`${(f(z,g).rank-1)*v.squareSize}px`}:{width:`${v.squareSize}px`,height:`${v.squareSize}px`,right:`${(f(z,g).file-1)*v.squareSize}px`,top:`${(f(z,g).rank-1)*v.squareSize}px`})},[a.value&&A(V)(a.value,f(z,g))?(h(),D(Kl,{key:0,moves:F.value,"model-value":(Y=A(V)(a.value,f(z,g)))!=null?Y:!1,size:v.squareSize,onClick:Q,onDismiss:b},null,8,["moves","model-value","size"])):L("",!0),i.value!==null&&(A(Le)(f(z,g),"white")||A(Le)(f(z,g),"black"))?(h(),D(Nl,{key:1,"model-value":(W=A(V)(r.value,f(z,g)))!=null?W:!1,allegiance:i.value,size:v.squareSize,onClick:K=>$(f(z,g),K),onDismiss:u},null,8,["model-value","allegiance","size","onClick"])):L("",!0)],14,Ul)),[[Ue,!O(f(z,g))&&!d(f(z,g))]])])}),128))]))),128))]))}});var Xl=ue(Yl,[["__scopeId","data-v-5931f228"]]);const Jl={class:"relative-position full-width full-height column no-pointer-events indicators-layer"},Zl=I({__name:"indicators-layer",props:{board:{},ranks:{},files:{},squareSize:{},perspective:{},pieceFocus:{},lastMove:{}},setup(e){const l=e,t=p(()=>l.pieceFocus?l.board.getValidMoves(l.pieceFocus).map(m=>m.kind!=="move"?null:m.to).filter(Boolean):[]),a=s=>t.value.some(d=>d&&V(s,d)),n=s=>!l.board.getSquare(s),r=(s,d)=>{const m=s+1,y=d+1;return l.perspective==="white"?{file:m,rank:9-y}:{file:9-m,rank:y}},i=p(()=>l.board.getCheckMoves()),o=s=>i.value.some(d=>d.kind==="move"&&V(d.to,s));return(s,d)=>(h(),M("div",Jl,[(h(!0),M(J,null,Z(s.ranks,(m,y)=>(h(),M("div",{class:"col column row full-width",key:y},[(h(!0),M(J,null,Z(s.files,($,u)=>{var b,Q;return h(),M("div",{key:u,class:le(["full-height move-placeholder",{even:y%2===0?u%2===0:u%2!==0,focus:A(V)(s.pieceFocus,r(u,y)),show:a(r(u,y)),capture:!n(r(u,y)),target:n(r(u,y)),checked:o(r(u,y)),"last-from":((b=s.lastMove)==null?void 0:b.kind)==="move"&&A(V)(s.lastMove.from,r(u,y)),"last-to":((Q=s.lastMove)==null?void 0:Q.kind)==="move"&&A(V)(s.lastMove.to,r(u,y))}])},null,2)}),128))]))),128))]))}});var Il=ue(Zl,[["__scopeId","data-v-b504cbe8"]]);const eo={class:"relative-position full-width full-height no-pointer-events pieces-layer"},to=I({__name:"pieces-layer",props:{modelValue:{},squareSize:{},perspective:{}},setup(e){const l=Fe();return(t,a)=>(h(),M("div",eo,[(h(!0),M(J,null,Z(t.modelValue,(n,r)=>(h(),M("div",{key:r},[n?(h(),D(he,{key:0,"data-testid":"piece",class:le(["absolute",{"q-pa-xs":A(l).screen.sm||A(l).screen.md,"q-pa-sm":A(l).screen.gt.sm}]),piece:n.piece,allegiance:n.allegiance,size:t.squareSize,style:Me(t.perspective==="white"?{left:`${(n.file-1)*t.squareSize}px`,bottom:`${(n.rank-1)*t.squareSize}px`}:{right:`${(n.file-1)*t.squareSize}px`,top:`${(n.rank-1)*t.squareSize}px`})},null,8,["class","piece","allegiance","size","style"])):(h(),M("div",{key:1,style:Me({width:`${t.squareSize}px`,height:`${t.squareSize}px`})},null,4))]))),128))]))}});var lo=ue(to,[["__scopeId","data-v-32a0cdca"]]);const oo={class:"absolute full-width full-height"},ao={class:"absolute full-width full-height"},io={class:"absolute full-width full-height"},no={class:"absolute full-width full-height"},Lo=I({__name:"chess-board",props:{board:{},width:{},perspective:{},playAs:{},roundedBorders:{type:Boolean}},emits:["execute-node-index"],setup(e,{emit:l}){const t=e,a=p(()=>t.width/8),n=P(null),r=o=>{l("execute-node-index",o),n.value=null},i=p(()=>{var s;return(s=t.board.getMoveHistoryAst().children.at(-1))!=null?s:null});return(o,s)=>(h(),M("div",{"data-testid":"chess-board",class:le(["relative-position column",{"rounded-borders overflow-hidden":o.roundedBorders}]),style:Me({width:t.width+"px",height:t.width+"px"})},[N("div",oo,[w(Ml,{ranks:8,files:8,perspective:o.perspective},null,8,["perspective"])]),N("div",ao,[w(Il,{board:o.board,"square-size":a.value,files:8,ranks:8,perspective:o.perspective,"piece-focus":n.value,"last-move":i.value},null,8,["board","square-size","perspective","piece-focus","last-move"])]),N("div",io,[w(lo,{"model-value":o.board.getSquares(),perspective:t.perspective,"square-size":a.value},null,8,["model-value","perspective","square-size"])]),N("div",no,[w(Xl,{onExecuteNodeIndex:r,onUpdatePieceFocus:s[0]||(s[0]=d=>n.value=d),"piece-focus":n.value,board:o.board,"square-size":a.value,files:8,ranks:8,perspective:t.perspective},null,8,["piece-focus","board","square-size","perspective"])])],6))}}),so={xs:8,sm:10,md:14,lg:20,xl:24};var ft=ke({name:"QChip",props:{...Ye,...al,dense:Boolean,icon:String,iconRight:String,iconRemove:String,iconSelected:String,label:[String,Number],color:String,textColor:String,modelValue:{type:Boolean,default:!0},selected:{type:Boolean,default:null},square:Boolean,outline:Boolean,clickable:Boolean,removable:Boolean,removeAriaLabel:String,tabindex:[String,Number],disable:Boolean,ripple:{type:[Boolean,Object],default:!0}},emits:["update:modelValue","update:selected","remove","click"],setup(e,{slots:l,emit:t}){const{proxy:{$q:a}}=ge(),n=Xe(e,a),r=il(e,so),i=p(()=>e.selected===!0||e.icon!==void 0),o=p(()=>e.selected===!0?e.iconSelected||a.iconSet.chip.selected:e.icon),s=p(()=>e.iconRemove||a.iconSet.chip.remove),d=p(()=>e.disable===!1&&(e.clickable===!0||e.selected!==null)),m=p(()=>{const f=e.outline===!0&&e.color||e.textColor;return"q-chip row inline no-wrap items-center"+(e.outline===!1&&e.color!==void 0?` bg-${e.color}`:"")+(f?` text-${f} q-chip--colored`:"")+(e.disable===!0?" disabled":"")+(e.dense===!0?" q-chip--dense":"")+(e.outline===!0?" q-chip--outline":"")+(e.selected===!0?" q-chip--selected":"")+(d.value===!0?" q-chip--clickable cursor-pointer non-selectable q-hoverable":"")+(e.square===!0?" q-chip--square":"")+(n.value===!0?" q-chip--dark q-dark":"")}),y=p(()=>{const f=e.disable===!0?{tabindex:-1,"aria-disabled":"true"}:{tabindex:e.tabindex||0},O={...f,role:"button","aria-hidden":"false","aria-label":e.removeAriaLabel||a.lang.label.remove};return{chip:f,remove:O}});function $(f){f.keyCode===13&&u(f)}function u(f){e.disable||(t("update:selected",!e.selected),t("click",f))}function b(f){(f.keyCode===void 0||f.keyCode===13)&&(zt(f),e.disable===!1&&(t("update:modelValue",!1),t("remove")))}function Q(){const f=[];d.value===!0&&f.push(E("div",{class:"q-focus-helper"})),i.value===!0&&f.push(E(ie,{class:"q-chip__icon q-chip__icon--left",name:o.value}));const O=e.label!==void 0?[E("div",{class:"ellipsis"},[e.label])]:void 0;return f.push(E("div",{class:"q-chip__content col row no-wrap items-center q-anchor--skip"},sl(l.default,O))),e.iconRight&&f.push(E(ie,{class:"q-chip__icon q-chip__icon--right",name:e.iconRight})),e.removable===!0&&f.push(E(ie,{class:"q-chip__icon q-chip__icon--remove cursor-pointer",name:s.value,...y.value.remove,onClick:b,onKeyup:b})),f}return()=>{if(e.modelValue===!1)return;const f={class:m.value,style:r.value};return d.value===!0&&Object.assign(f,y.value.chip,{onClick:u,onKeyup:$}),nl("div",f,Q(),"ripple",e.ripple!==!1&&e.disable!==!0,()=>[[Ue,e.ripple]])}}});const ht=["vertical","horizontal"],We={vertical:{offset:"offsetY",scroll:"scrollTop",dir:"down",dist:"y"},horizontal:{offset:"offsetX",scroll:"scrollLeft",dir:"right",dist:"x"}},mt={prevent:!0,mouse:!0,mouseAllDir:!0},pt=e=>e>=250?50:Math.ceil(e/5);var ro=ke({name:"QScrollArea",props:{...Ye,thumbStyle:Object,verticalThumbStyle:Object,horizontalThumbStyle:Object,barStyle:[Array,String,Object],verticalBarStyle:[Array,String,Object],horizontalBarStyle:[Array,String,Object],contentStyle:[Array,String,Object],contentActiveStyle:[Array,String,Object],delay:{type:[String,Number],default:1e3},visible:{type:Boolean,default:null},tabindex:[String,Number],onScroll:Function},setup(e,{slots:l,emit:t}){const a=P(!1),n=P(!1),r=P(!1),i={vertical:P(0),horizontal:P(0)},o={vertical:{ref:P(null),position:P(0),size:P(0)},horizontal:{ref:P(null),position:P(0),size:P(0)}},{proxy:s}=ge(),d=Xe(e,s.$q);let m=null,y;const $=P(null),u=p(()=>"q-scrollarea"+(d.value===!0?" q-scrollarea--dark":""));o.vertical.percentage=p(()=>{const c=o.vertical.size.value-i.vertical.value;if(c<=0)return 0;const _=we(o.vertical.position.value/c,0,1);return Math.round(_*1e4)/1e4}),o.vertical.thumbHidden=p(()=>(e.visible===null?r.value:e.visible)!==!0&&a.value===!1&&n.value===!1||o.vertical.size.value<=i.vertical.value+1),o.vertical.thumbStart=p(()=>o.vertical.percentage.value*(i.vertical.value-o.vertical.thumbSize.value)),o.vertical.thumbSize=p(()=>Math.round(we(i.vertical.value*i.vertical.value/o.vertical.size.value,pt(i.vertical.value),i.vertical.value))),o.vertical.style=p(()=>({...e.thumbStyle,...e.verticalThumbStyle,top:`${o.vertical.thumbStart.value}px`,height:`${o.vertical.thumbSize.value}px`})),o.vertical.thumbClass=p(()=>"q-scrollarea__thumb q-scrollarea__thumb--v absolute-right"+(o.vertical.thumbHidden.value===!0?" q-scrollarea__thumb--invisible":"")),o.vertical.barClass=p(()=>"q-scrollarea__bar q-scrollarea__bar--v absolute-right"+(o.vertical.thumbHidden.value===!0?" q-scrollarea__bar--invisible":"")),o.horizontal.percentage=p(()=>{const c=o.horizontal.size.value-i.horizontal.value;if(c<=0)return 0;const _=we(Math.abs(o.horizontal.position.value)/c,0,1);return Math.round(_*1e4)/1e4}),o.horizontal.thumbHidden=p(()=>(e.visible===null?r.value:e.visible)!==!0&&a.value===!1&&n.value===!1||o.horizontal.size.value<=i.horizontal.value+1),o.horizontal.thumbStart=p(()=>o.horizontal.percentage.value*(i.horizontal.value-o.horizontal.thumbSize.value)),o.horizontal.thumbSize=p(()=>Math.round(we(i.horizontal.value*i.horizontal.value/o.horizontal.size.value,pt(i.horizontal.value),i.horizontal.value))),o.horizontal.style=p(()=>({...e.thumbStyle,...e.horizontalThumbStyle,[s.$q.lang.rtl===!0?"right":"left"]:`${o.horizontal.thumbStart.value}px`,width:`${o.horizontal.thumbSize.value}px`})),o.horizontal.thumbClass=p(()=>"q-scrollarea__thumb q-scrollarea__thumb--h absolute-bottom"+(o.horizontal.thumbHidden.value===!0?" q-scrollarea__thumb--invisible":"")),o.horizontal.barClass=p(()=>"q-scrollarea__bar q-scrollarea__bar--h absolute-bottom"+(o.horizontal.thumbHidden.value===!0?" q-scrollarea__bar--invisible":""));const b=p(()=>o.vertical.thumbHidden.value===!0&&o.horizontal.thumbHidden.value===!0?e.contentStyle:e.contentActiveStyle),Q=[[ot,c=>{g(c,"vertical")},void 0,{vertical:!0,...mt}]],f=[[ot,c=>{g(c,"horizontal")},void 0,{horizontal:!0,...mt}]];function O(){const c={};return ht.forEach(_=>{const C=o[_];c[_+"Position"]=C.position.value,c[_+"Percentage"]=C.percentage.value,c[_+"Size"]=C.size.value,c[_+"ContainerSize"]=i[_].value}),c}const j=rl(()=>{const c=O();c.ref=s,t("scroll",c)},0);function F(c,_,C){if(ht.includes(c)===!1){console.error("[QScrollArea]: wrong first param of setScrollPosition (vertical/horizontal)");return}(c==="vertical"?lt:Oe)($.value,_,C)}function v({height:c,width:_}){let C=!1;i.vertical.value!==c&&(i.vertical.value=c,C=!0),i.horizontal.value!==_&&(i.horizontal.value=_,C=!0),C===!0&&W()}function S({position:c}){let _=!1;o.vertical.position.value!==c.top&&(o.vertical.position.value=c.top,_=!0),o.horizontal.position.value!==c.left&&(o.horizontal.position.value=c.left,_=!0),_===!0&&W()}function T({height:c,width:_}){o.horizontal.size.value!==_&&(o.horizontal.size.value=_,W()),o.vertical.size.value!==c&&(o.vertical.size.value=c,W())}function g(c,_){const C=o[_];if(c.isFirst===!0){if(C.thumbHidden.value===!0)return;y=C.position.value,n.value=!0}else if(n.value!==!0)return;c.isFinal===!0&&(n.value=!1);const R=We[_],G=i[_].value,be=(C.size.value-G)/(G-C.thumbSize.value),de=c.distance[R.dist],te=y+(c.direction===R.dir?1:-1)*de*be;K(te,_)}function B(c,_){const C=o[_];if(C.thumbHidden.value!==!0){const R=c[We[_].offset];if(R<C.thumbStart.value||R>C.thumbStart.value+C.thumbSize.value){const G=R-C.thumbSize.value/2;K(G/i[_].value*C.size.value,_)}C.ref.value!==null&&C.ref.value.dispatchEvent(new MouseEvent(c.type,c))}}function z(c){B(c,"vertical")}function Y(c){B(c,"horizontal")}function W(){a.value=!0,m!==null&&clearTimeout(m),m=setTimeout(()=>{m=null,a.value=!1},e.delay),e.onScroll!==void 0&&j()}function K(c,_){$.value[We[_].scroll]=c}function oe(){r.value=!0}function ce(){r.value=!1}let ee=null;return U(()=>s.$q.lang.rtl,c=>{$.value!==null&&Oe($.value,Math.abs(o.horizontal.position.value)*(c===!0?-1:1))}),St(()=>{ee={top:o.vertical.position.value,left:o.horizontal.position.value}}),ul(()=>{if(ee===null)return;const c=$.value;c!==null&&(Oe(c,ee.left),lt(c,ee.top))}),pe(j.cancel),Object.assign(s,{getScrollTarget:()=>$.value,getScroll:O,getScrollPosition:()=>({top:o.vertical.position.value,left:o.horizontal.position.value}),getScrollPercentage:()=>({top:o.vertical.percentage.value,left:o.horizontal.percentage.value}),setScrollPosition:F,setScrollPercentage(c,_,C){F(c,_*(o[c].size.value-i[c].value)*(c==="horizontal"&&s.$q.lang.rtl===!0?-1:1),C)}}),()=>E("div",{class:u.value,onMouseenter:oe,onMouseleave:ce},[E("div",{ref:$,class:"q-scrollarea__container scroll relative-position fit hide-scrollbar",tabindex:e.tabindex!==void 0?e.tabindex:void 0},[E("div",{class:"q-scrollarea__content absolute",style:b.value},cl(l.default,[E(tt,{debounce:0,onResize:T})])),E(yl,{axis:"both",onScroll:S})]),E(tt,{debounce:0,onResize:v}),E("div",{class:o.vertical.barClass.value,style:[e.barStyle,e.verticalBarStyle],"aria-hidden":"true",onMousedown:z}),E("div",{class:o.horizontal.barClass.value,style:[e.barStyle,e.horizontalBarStyle],"aria-hidden":"true",onMousedown:Y}),ye(E("div",{ref:o.vertical.ref,class:o.vertical.thumbClass.value,style:o.vertical.style.value,"aria-hidden":"true"}),Q),ye(E("div",{ref:o.horizontal.ref,class:o.horizontal.thumbClass.value,style:o.horizontal.style.value,"aria-hidden":"true"}),f)])}});const He=e=>(vl("data-v-4b85c492"),e=e(),fl(),e),uo=He(()=>N("div",{class:"text-h6"},"Your turn!",-1)),co=He(()=>N("div",{class:"text-h6"},"Waiting for opponent...",-1)),vo=He(()=>N("div",{class:"text-h6"},"Game over!",-1)),fo=He(()=>N("div",{class:"spacer col"},null,-1)),ho={"data-testid":"default-slot"},mo={"data-testid":"afen"},po={"data-testid":"move-history"},go={key:0,class:"col"},bo={key:0,class:"col"},_o=I({__name:"game-sidebar",props:{moveHistory:{},activeColour:{},ownColour:{},afen:{},gameOver:{}},setup(e){const l=e,t=p(()=>{const i=[];return l.moveHistory.children.forEach(o=>{const s=i.at(-1);if(!s||s.length!==1){i.push([o]);return}s.push(o)}),i}),a=P(null);U(t,()=>{!a.value||a.value.setScrollPosition("vertical",t.value.length*36,1e3)}),yt(()=>{!a.value||a.value.setScrollPosition("vertical",t.value.length*36,1e3)});const n=Fe(),r=()=>{if(!!l.afen)try{navigator.clipboard.writeText(l.afen),n.notify({position:"bottom-right",timeout:4e3,message:"AFEN copied to clipboard",icon:"content_copy"})}catch{n.notify({position:"bottom-right",timeout:4e3,message:"Could not write to clipboard",icon:"close",iconColor:"red"})}};return(i,o)=>(h(),D(Pt,{flat:"",bordered:"",class:"q-ma-md full-height column justify-between","data-testid":"game-sidebar"},{default:x(()=>[w(_e,{mode:"out-in"},{default:x(()=>[!i.gameOver&&i.activeColour===i.ownColour?(h(),D(ae,{key:0,class:"bg-primary text-white q-mb-md"},{default:x(()=>[uo]),_:1})):i.gameOver?(h(),D(ae,{key:2,class:"bg-negative text-white q-mb-md"},{default:x(()=>[vo]),_:1})):(h(),D(ae,{key:1,class:"bg-grey text-black q-mb-md"},{default:x(()=>[co]),_:1}))]),_:1}),fo,N("div",ho,[w(xe),dl(i.$slots,"default",{},void 0,!0)]),N("div",mo,[w(xe),ye((h(),D(Pe,{clickable:"",onClick:r},{default:x(()=>[w(Se,{class:"q-mt-sm q-mb-sm"},{default:x(()=>[w(it,null,{default:x(()=>[qe("AFEN")]),_:1}),w(it,{caption:"",lines:"2"},{default:x(()=>[qe(ve(i.afen),1)]),_:1})]),_:1}),w(Se,{side:""},{default:x(()=>[w(ie,{name:"edit"})]),_:1})]),_:1})),[[Ue]])]),N("div",po,[w(xe),w(A(ro),{style:{height:"500px"},ref_key:"moveHistoryScrollArea",ref:a},{default:x(()=>[(h(!0),M(J,null,Z(t.value,(s,d)=>(h(),D(ae,{key:d,horizontal:"",class:le(["row q-py-none q-mx-md",{"q-pt-md":d===0,"q-pb-md":d===t.value.length-1}])},{default:x(()=>[s[0]?(h(),M("div",go,[w(ft,{ripple:!1,class:le(["white-move",{highlight:s[0].kind!=="move"}])},{default:x(()=>[s[0].kind==="move"&&s[0].piece?(h(),D(he,{key:0,piece:s[0].piece,allegiance:3,size:24},null,8,["piece"])):L("",!0),qe(" "+ve(A(nt).writeNode(s[0])),1)]),_:2},1032,["class"])])):L("",!0),w(_e,{mode:"out-in"},{default:x(()=>[s[1]?(h(),M("div",bo,[w(ft,{ripple:!1,class:le(["black-move",{highlight:s[1].kind!=="move"}])},{default:x(()=>[s[1].kind==="move"&&s[1].piece?(h(),D(he,{key:0,piece:s[1].piece,allegiance:0,size:24},null,8,["piece"])):L("",!0),qe(" "+ve(A(nt).writeNode(s[1])),1)]),_:2},1032,["class"])])):L("",!0)]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1},512)])]),_:3}))}});var Oo=ue(_o,[["__scopeId","data-v-4b85c492"]]),yo=ke({name:"QCardActions",props:{...hl,vertical:Boolean},setup(e,{slots:l}){const t=ml(e),a=p(()=>`q-card__actions ${t.value} q-card__actions--${e.vertical===!0?"vert column":"horiz row"}`);return()=>E("div",{class:a.value},Ge(l.default))}});let Ce=0;const So={standard:"fixed-full flex-center",top:"fixed-top justify-center",bottom:"fixed-bottom justify-center",right:"fixed-right items-center",left:"fixed-left items-center"},gt={standard:["scale","scale"],top:["slide-down","slide-up"],bottom:["slide-up","slide-down"],right:["slide-left","slide-right"],left:["slide-right","slide-left"]};var ko=ke({name:"QDialog",inheritAttrs:!1,props:{...wt,...Bt,transitionShow:String,transitionHide:String,persistent:Boolean,autoClose:Boolean,allowFocusOutside:Boolean,noEscDismiss:Boolean,noBackdropDismiss:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,noShake:Boolean,seamless:Boolean,maximized:Boolean,fullWidth:Boolean,fullHeight:Boolean,square:Boolean,position:{type:String,default:"standard",validator:e=>e==="standard"||["top","bottom","left","right"].includes(e)}},emits:[...Ct,"shake","click","escapeKey"],setup(e,{slots:l,emit:t,attrs:a}){const n=ge(),r=P(null),i=P(!1),o=P(!1);let s=null,d=null,m,y;const $=p(()=>e.persistent!==!0&&e.noRouteDismiss!==!0&&e.seamless!==!0),{preventBodyScroll:u}=kl(),{registerTimeout:b}=$t(),{registerTick:Q,removeTick:f}=Ht(),{transitionProps:O,transitionStyle:j}=Ft(e,()=>gt[e.position][0],()=>gt[e.position][1]),{showPortal:F,hidePortal:v,portalIsAccessible:S,renderPortal:T}=Tt(n,r,Ae,"dialog"),{hide:g}=xt({showing:i,hideOnRouteChange:$,handleShow:ce,handleHide:ee,processOnMount:!0}),{addToHistory:B,removeFromHistory:z}=Sl(i,g,$),Y=p(()=>`q-dialog__inner flex no-pointer-events q-dialog__inner--${e.maximized===!0?"maximized":"minimized"} q-dialog__inner--${e.position} ${So[e.position]}`+(o.value===!0?" q-dialog__inner--animating":"")+(e.fullWidth===!0?" q-dialog__inner--fullwidth":"")+(e.fullHeight===!0?" q-dialog__inner--fullheight":"")+(e.square===!0?" q-dialog__inner--square":"")),W=p(()=>i.value===!0&&e.seamless!==!0),K=p(()=>e.autoClose===!0?{onClick:be}:{}),oe=p(()=>[`q-dialog fullscreen no-pointer-events q-dialog--${W.value===!0?"modal":"seamless"}`,a.class]);U(()=>e.maximized,q=>{i.value===!0&&G(q)}),U(W,q=>{u(q),q===!0?(Ot(te),Dt(C)):(je(te),Ee(C))});function ce(q){B(),d=e.noRefocus===!1&&document.activeElement!==null?document.activeElement:null,G(e.maximized),F(),o.value=!0,e.noFocus!==!0?(document.activeElement!==null&&document.activeElement.blur(),Q(c)):f(),b(()=>{if(n.proxy.$q.platform.is.ios===!0){if(e.seamless!==!0&&document.activeElement){const{top:H,bottom:X}=document.activeElement.getBoundingClientRect(),{innerHeight:ze}=window,k=window.visualViewport!==void 0?window.visualViewport.height:ze;H>0&&X>k/2&&(document.scrollingElement.scrollTop=Math.min(document.scrollingElement.scrollHeight-k,X>=ze?1/0:Math.ceil(document.scrollingElement.scrollTop+X-k/2))),document.activeElement.scrollIntoView()}y=!0,r.value.click(),y=!1}F(!0),o.value=!1,t("show",q)},e.transitionDuration)}function ee(q){f(),z(),R(!0),o.value=!0,v(),d!==null&&(((q&&q.type.indexOf("key")===0?d.closest('[tabindex]:not([tabindex^="-"])'):void 0)||d).focus(),d=null),b(()=>{v(!0),o.value=!1,t("hide",q)},e.transitionDuration)}function c(q){Mt(()=>{let H=r.value;H===null||H.contains(document.activeElement)===!0||(H=(q!==""?H.querySelector(q):null)||H.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||H.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||H.querySelector("[autofocus], [data-autofocus]")||H,H.focus({preventScroll:!0}))})}function _(q){q&&typeof q.focus=="function"?q.focus({preventScroll:!0}):c(),t("shake");const H=r.value;H!==null&&(H.classList.remove("q-animate--scale"),H.classList.add("q-animate--scale"),s!==null&&clearTimeout(s),s=setTimeout(()=>{s=null,r.value!==null&&(H.classList.remove("q-animate--scale"),c())},170))}function C(){e.seamless!==!0&&(e.persistent===!0||e.noEscDismiss===!0?e.maximized!==!0&&e.noShake!==!0&&_():(t("escapeKey"),g()))}function R(q){s!==null&&(clearTimeout(s),s=null),(q===!0||i.value===!0)&&(G(!1),e.seamless!==!0&&(u(!1),je(te),Ee(C))),q!==!0&&(d=null)}function G(q){q===!0?m!==!0&&(Ce<1&&document.body.classList.add("q-body--dialog"),Ce++,m=!0):m===!0&&(Ce<2&&document.body.classList.remove("q-body--dialog"),Ce--,m=!1)}function be(q){y!==!0&&(g(q),t("click",q))}function de(q){e.persistent!==!0&&e.noBackdropDismiss!==!0?g(q):e.noShake!==!0&&_()}function te(q){e.allowFocusOutside!==!0&&S.value===!0&&kt(r.value,q.target)!==!0&&c('[tabindex]:not([tabindex="-1"])')}Object.assign(n.proxy,{focus:c,shake:_,__updateRefocusTarget(q){d=q||null}}),pe(R);function Ae(){return E("div",{role:"dialog","aria-modal":W.value===!0?"true":"false",...a,class:oe.value},[E(_e,{name:"q-transition--fade",appear:!0},()=>W.value===!0?E("div",{class:"q-dialog__backdrop fixed-full",style:j.value,"aria-hidden":"true",tabindex:-1,onClick:de}):null),E(_e,O.value,()=>i.value===!0?E("div",{ref:r,class:Y.value,style:j.value,tabindex:-1,...K.value},Ge(l.default)):null)])}return T}});function bt(e){if(e===!1)return 0;if(e===!0||e===void 0)return 1;const l=parseInt(e,10);return isNaN(l)?0:l}var zo=pl({name:"close-popup",beforeMount(e,{value:l}){const t={depth:bt(l),handler(a){t.depth!==0&&setTimeout(()=>{const n=Bl(e);n!==void 0&&Fl(n,a,t.depth)})},handlerKey(a){Ne(a,13)===!0&&t.handler(a)}};e.__qclosepopup=t,e.addEventListener("click",t.handler),e.addEventListener("keyup",t.handlerKey)},updated(e,{value:l,oldValue:t}){l!==t&&(e.__qclosepopup.depth=bt(l))},beforeUnmount(e){const l=e.__qclosepopup;e.removeEventListener("click",l.handler),e.removeEventListener("keyup",l.handlerKey),delete e.__qclosepopup}});const qo={key:0},wo={key:1},Co={key:2},$o={key:0,class:"text-subtitle1 text-center"},xo=I({__name:"game-over-dialog",props:{node:{}},setup(e){return(l,t)=>(h(),D(ko,{"model-value":!0,persistent:"",position:"bottom"},{default:x(()=>[w(Pt,{class:"my-card game-over-dialog"},{default:x(()=>[w(ae,{class:"bg-primary text-h5 row justify-between"},{default:x(()=>[l.node.outcome==="white"?(h(),M("span",qo,"White wins!")):L("",!0),l.node.outcome==="black"?(h(),M("span",wo,"Black wins!")):L("",!0),l.node.outcome==="draw"?(h(),M("span",Co,"Draw!")):L("",!0),ye(w(et,{icon:"close",flat:"",round:"",dense:""},null,512),[[zo]])]),_:1}),w(ae,{class:"row justify-center"},{default:x(()=>[l.node.outcome==="white"?(h(),D(he,{key:0,allegiance:A(Je).White,piece:"K",size:96},null,8,["allegiance"])):L("",!0),l.node.outcome==="black"?(h(),D(he,{key:1,allegiance:A(Je).Black,piece:"K",size:96},null,8,["allegiance"])):L("",!0),l.node.outcome==="draw"?(h(),D(ie,{key:2,name:"balance",size:"96px",color:"grey"})):L("",!0)]),_:1}),w(ae,{class:"q-pt-none"},{default:x(()=>[l.node.reason?(h(),M("div",$o,ve(l.node.reason),1)):L("",!0)]),_:1}),w(xe),w(yo,{align:"right"},{default:x(()=>[w(et,{color:"secondary","text-color":"primary",label:"New game",to:"/play"})]),_:1})]),_:1})]),_:1}))}});var Qo=ue(xo,[["__scopeId","data-v-fc28b0e2"]]);const Wo=()=>{const e=Fe();return p(()=>{let l=e.screen.width;return e.screen.gt.xs&&(l=e.screen.width-65),e.screen.gt.sm&&(l=e.screen.sizes.sm),e.screen.gt.md&&(l=e.screen.sizes.md-265),e.screen.gt.lg&&(l=e.screen.sizes.lg-265),Math.min(l,e.screen.height)})};export{Oo as G,Lo as _,Qo as a,Wo as u};
//# sourceMappingURL=board-size.bdcbe4f0.js.map
