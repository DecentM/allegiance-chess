{"version":3,"file":"pen-pal-game.db995223.js","sources":["../../../../../src/pages/play/pen-pal-game.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { useRoute, useRouter } from 'vue-router'\nimport { computed, onMounted, watch } from 'vue'\nimport { useQuasar } from 'quasar'\n\nimport GameLayout from '../../components/game-layout.vue'\n\nimport ChessBoard from '../../components/chess-board.vue'\nimport GameSidebar from '../../components/game-sidebar.vue'\nimport GameOverDialog from '../../components/game-over-dialog.vue'\n\nimport { Hex } from '../../lib/hex'\nimport { useBoardWorker } from '../../hooks/board-worker'\n\nconst route = useRoute()\nconst router = useRouter()\n\nconst board = useBoardWorker({\n  autoplayFor: [],\n})\n\nconst state = computed(() => {\n  const afen = Array.isArray(route.params.state)\n    ? route.params.state[0]\n    : route.params.state\n\n  const history = Array.isArray(route.params.history)\n    ? route.params.history[0]\n    : route.params.history\n\n  return {\n    afen: Hex.hexToUtf8(afen),\n    history: Hex.hexToUtf8(history),\n  }\n})\n\nonMounted(() => {\n  board.reset()\n\n  if (state.value.afen) board.importAfen(state.value.afen)\n  if (state.value.history) board.importMoveHistory(state.value.history)\n})\n\nconst handleExecuteNodeIndex = (index: number) => {\n  board.executeMoveIndex(index)\n}\n\nwatch(board.afen, (newAfen) => {\n  router.push({\n    path: `/play/pen-pal/${Hex.utf8ToHex(newAfen)}/${Hex.utf8ToHex(\n      state.value.history\n    )}`,\n  })\n})\n\nconst q = useQuasar()\n</script>\n\n<template>\n  <game-layout>\n    <template #board>\n      <chess-board\n        @execute-node-index=\"handleExecuteNodeIndex\"\n        :board=\"board\"\n        :perspective=\"board.activeColour.value\"\n        :active-colour=\"board.activeColour.value\"\n        :check-moves=\"board.checkMoves.value\"\n        :en-passant-target=\"board.enPassantTarget.value\"\n        :move-history-ast=\"board.moveHistoryAst.value\"\n        :squares=\"board.squares.value\"\n        :valid-moves=\"board.validMoves.value\"\n        :play-as=\"['white', 'black']\"\n        :rounded-borders=\"q.screen.gt.xs\"\n      />\n    </template>\n\n    <template #sidebar>\n      <game-sidebar\n        :move-history=\"board.moveHistoryAst.value\"\n        :active-colour=\"board.activeColour.value\"\n        :own-colour=\"board.activeColour.value\"\n        :afen=\"board.afen.value\"\n        :game-over=\"board.gameOver.value\"\n      />\n    </template>\n\n    <template #default>\n      <game-over-dialog\n        v-if=\"board.gameOver.value\"\n        :node=\"board.gameOver.value\"\n      />\n    </template>\n  </game-layout>\n</template>\n"],"names":["route","useRoute","router","useRouter","board","useBoardWorker","state","computed","afen","history","Hex","onMounted","handleExecuteNodeIndex","index","watch","newAfen","q","useQuasar"],"mappings":"6lBAcA,MAAMA,EAAQC,IACRC,EAASC,IAETC,EAAQC,EAAe,CAC3B,YAAa,CAAC,CAAA,CACf,EAEKC,EAAQC,EAAS,IAAM,CAC3B,MAAMC,EAAO,MAAM,QAAQR,EAAM,OAAO,KAAK,EACzCA,EAAM,OAAO,MAAM,GACnBA,EAAM,OAAO,MAEXS,EAAU,MAAM,QAAQT,EAAM,OAAO,OAAO,EAC9CA,EAAM,OAAO,QAAQ,GACrBA,EAAM,OAAO,QAEV,MAAA,CACL,KAAMU,EAAI,UAAUF,CAAI,EACxB,QAASE,EAAI,UAAUD,CAAO,CAAA,CAChC,CACD,EAEDE,EAAU,IAAM,CACdP,EAAM,MAAM,EAERE,EAAM,MAAM,MAAYF,EAAA,WAAWE,EAAM,MAAM,IAAI,EACnDA,EAAM,MAAM,SAAeF,EAAA,kBAAkBE,EAAM,MAAM,OAAO,CAAA,CACrE,EAEK,MAAAM,EAA0BC,GAAkB,CAChDT,EAAM,iBAAiBS,CAAK,CAAA,EAGxBC,EAAAV,EAAM,KAAOW,GAAY,CAC7Bb,EAAO,KAAK,CACV,KAAM,iBAAiBQ,EAAI,UAAUK,CAAO,KAAKL,EAAI,UACnDJ,EAAM,MAAM,OAAA,GACd,CACD,CAAA,CACF,EAED,MAAMU,EAAIC"}