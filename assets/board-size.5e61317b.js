import{p as Vt,t as Nt,w as Kt,a as Gt,f as Ut,c as V,i as Ae,b as Yt,P as Je}from"./board.c16f8167.js";import{u as xe}from"./use-quasar.70ee791f.js";import{A as I,B as m,E as P,J,F as Z,_ as re,N as le,M as A,I as de,O as L,r as T,ac as Ve,a6 as Ze,n as _t,a4 as Ie,w as G,k as yt,o as pe,j as ge,a9 as Xt,S as Qe,au as $e,z as Jt,ao as Zt,h as B,av as It,aw as el,ax as tl,a as p,$ as St,a0 as ll,X as Ne,c as ke,a8 as ol,e as Ke,ad as _e,ay as kt,Y as zt,C as D,D as E,G as w,u as ae,m as ye,az as Ge,aj as Pe,af as X,aA as al,aB as il,p as nl,aC as sl,an as rl,aq as ul,s as cl,H as qe,as as dl,at as vl,aD as fl,aE as hl,a2 as ml,Q as et}from"./index.b271fcf9.js";import{b as Ee,a as Se,Q as qt}from"./QList.6317c7be.js";import{i as pl,g as gl,u as wt,a as Ct,b as $t,c as Pt,j as bl,e as we,Q as tt,h as _l,s as lt,k as De,T as ot,d as yl,f as Sl}from"./QScrollObserver.751e0e8d.js";import{u as Ue,a as Ye}from"./use-dark.fb55bdf3.js";import{b as at,c as kl,a as Et}from"./focus-manager.202af5b7.js";import{C as he,Q as it}from"./chess-piece.049befa3.js";import{Q as Tt,a as ve,b as We}from"./QCard.7b376b72.js";const zl={White:"white",Black:"black",Draw:"draw",Forfeit:"forfeit",ForfeitWhite:"forfeit-white",ForfeitBlack:"forfeit-black"};var nt=Object.freeze(Object.defineProperty({__proto__:null,GameOutcome:zl,parse:Vt,tokenize:Nt,writeNode:Kt,write:Gt},Symbol.toStringTag,{value:"Module"}));const ql={class:"row column full-width full-height no-pointer-events background-layer","data-testid":"background"},wl={key:0,class:"absolute absolute-bottom-right q-px-sm"},Cl={key:1,class:"absolute absolute-top-left q-pa-xs"},$l=I({__name:"background-layer",props:{ranks:{},files:{},perspective:{}},setup(e){const l=xe();return(t,a)=>(m(),P("div",ql,[(m(!0),P(J,null,Z(t.ranks,(n,r)=>(m(),P("div",{class:"rank col row full-width",key:r},[(m(!0),P(J,null,Z(t.files,(i,o)=>(m(),P("div",{key:o,class:le(["file col relative-position",{"text-h6 text-bold":A(l).screen.gt.sm,"text-subtitle1 text-bold":A(l).screen.sm,"text-subtitle2":A(l).screen.lt.sm}])},[r===7?(m(),P("span",wl,de(A(Ut)(t.perspective==="white"?9-(8-o):8-o)),1)):L("",!0),o===0?(m(),P("span",Cl,de(t.perspective==="white"?8-r:9-(8-r)),1)):L("",!0)],2))),128))]))),128))]))}});var Pl=re($l,[["__scopeId","data-v-5503eeb2"]]);const El={target:{default:!0},noParentEvent:Boolean,contextMenu:Boolean};function Tl({showing:e,avoidEmit:l,configureAnchorEl:t}){const{props:a,proxy:n,emit:r}=ge(),i=T(null);let o=null;function s(u){return i.value===null?!1:u===void 0||u.touches===void 0||u.touches.length<=1}const d={};t===void 0&&(Object.assign(d,{hide(u){n.hide(u)},toggle(u){n.toggle(u),u.qAnchorHandled=!0},toggleKey(u){Ve(u,13)===!0&&d.toggle(u)},contextClick(u){n.hide(u),Ze(u),_t(()=>{n.show(u),u.qAnchorHandled=!0})},prevent:Ze,mobileTouch(u){if(d.mobileCleanup(u),s(u)!==!0)return;n.hide(u),i.value.classList.add("non-selectable");const b=u.target;Ie(d,"anchor",[[b,"touchmove","mobileCleanup","passive"],[b,"touchend","mobileCleanup","passive"],[b,"touchcancel","mobileCleanup","passive"],[i.value,"contextmenu","prevent","notPassive"]]),o=setTimeout(()=>{o=null,n.show(u),u.qAnchorHandled=!0},300)},mobileCleanup(u){i.value.classList.remove("non-selectable"),o!==null&&(clearTimeout(o),o=null),e.value===!0&&u!==void 0&&pl()}}),t=function(u=a.contextMenu){if(a.noParentEvent===!0||i.value===null)return;let b;u===!0?n.$q.platform.is.mobile===!0?b=[[i.value,"touchstart","mobileTouch","passive"]]:b=[[i.value,"mousedown","hide","passive"],[i.value,"contextmenu","contextClick","notPassive"]]:b=[[i.value,"click","toggle","passive"],[i.value,"keyup","toggleKey","passive"]],Ie(d,"anchor",b)});function h(){Xt(d,"anchor")}function y(u){for(i.value=u;i.value.classList.contains("q-anchor--skip");)i.value=i.value.parentNode;t()}function $(){if(a.target===!1||a.target===""||n.$el.parentNode===null)i.value=null;else if(a.target===!0)y(n.$el.parentNode);else{let u=a.target;if(typeof a.target=="string")try{u=document.querySelector(a.target)}catch{u=void 0}u!=null?(i.value=u.$el||u,t()):(i.value=null,console.error(`Anchor: target "${a.target}" not found`))}}return G(()=>a.contextMenu,u=>{i.value!==null&&(h(),t(u))}),G(()=>a.target,()=>{i.value!==null&&h(),$()}),G(()=>a.noParentEvent,u=>{i.value!==null&&(u===!0?h():t())}),yt(()=>{$(),l!==!0&&a.modelValue===!0&&i.value===null&&r("update:modelValue",!1)}),pe(()=>{o!==null&&clearTimeout(o),h()}),{anchorEl:i,canShow:s,anchorEvents:d}}function Bl(e,l){const t=T(null);let a;function n(o,s){const d=`${s!==void 0?"add":"remove"}EventListener`,h=s!==void 0?s:a;o!==window&&o[d]("scroll",h,Qe.passive),window[d]("scroll",h,Qe.passive),a=s}function r(){t.value!==null&&(n(t.value),t.value=null)}const i=G(()=>e.noParentEvent,()=>{t.value!==null&&(r(),l())});return pe(i),{localScrollTarget:t,unconfigureScrollTarget:r,changeScrollEvent:n}}const fe=[];function Ml(e){return fe.find(l=>l.contentEl!==null&&l.contentEl.contains(e))}function Bt(e,l){do{if(e.$options.name==="QMenu"){if(e.hide(l),e.$props.separateClosePopup===!0)return $e(e)}else if(e.__qPortal===!0){const t=$e(e);return t!==void 0&&t.$options.name==="QPopupProxy"?(e.hide(l),t):e}e=$e(e)}while(e!=null)}function xl(e,l,t){for(;t!==0&&e!==void 0&&e!==null;){if(e.__qPortal===!0){if(t--,e.$options.name==="QMenu"){e=Bt(e,l);continue}e.hide(l)}e=$e(e)}}function Fl(e){for(e=e.parent;e!=null;){if(e.type.name==="QGlobalDialog")return!0;if(e.type.name==="QDialog"||e.type.name==="QMenu")return!1;e=e.parent}return!1}function Mt(e,l,t,a){const n=T(!1),r=T(!1);let i=null;const o={},s=a==="dialog"&&Fl(e);function d(y){if(y===!0){at(o),r.value=!0;return}r.value=!1,n.value===!1&&(s===!1&&i===null&&(i=el(!1,a)),n.value=!0,fe.push(e.proxy),kl(o))}function h(y){if(r.value=!1,y!==!0)return;at(o),n.value=!1;const $=fe.indexOf(e.proxy);$!==-1&&fe.splice($,1),i!==null&&(tl(i),i=null)}return Jt(()=>{h(!0)}),e.proxy.__qPortal=!0,Zt(e.proxy,"contentEl",()=>l.value),{showPortal:d,hidePortal:h,portalIsActive:n,portalIsAccessible:r,renderPortal:()=>s===!0?t():n.value===!0?[B(It,{to:i},t())]:void 0}}const xt={transitionShow:{type:String,default:"fade"},transitionHide:{type:String,default:"fade"},transitionDuration:{type:[String,Number],default:300}};function Ft(e,l=()=>{},t=()=>{}){return{transitionProps:p(()=>{const a=`q-transition--${e.transitionShow||l()}`,n=`q-transition--${e.transitionHide||t()}`;return{appear:!0,enterFromClass:`${a}-enter-from`,enterActiveClass:`${a}-enter-active`,enterToClass:`${a}-enter-to`,leaveFromClass:`${n}-leave-from`,leaveActiveClass:`${n}-leave-active`,leaveToClass:`${n}-leave-to`}}),transitionStyle:p(()=>`--q-transition-duration: ${e.transitionDuration}ms`)}}function Ht(){let e;const l=ge();function t(){e=void 0}return St(t),pe(t),{removeTick:t,registerTick(a){e=a,_t(()=>{e===a&&(ll(l)===!1&&e(),e=void 0)})}}}const ie=[];let me;function Hl(e){me=e.keyCode===27}function Al(){me===!0&&(me=!1)}function Dl(e){me===!0&&(me=!1,Ve(e,27)===!0&&ie[ie.length-1](e))}function At(e){window[e]("keydown",Hl),window[e]("blur",Al),window[e]("keyup",Dl),me=!1}function Dt(e){Ne.is.desktop===!0&&(ie.push(e),ie.length===1&&At("addEventListener"))}function Te(e){const l=ie.indexOf(e);l>-1&&(ie.splice(l,1),ie.length===0&&At("removeEventListener"))}const ne=[];function Lt(e){ne[ne.length-1](e)}function Ot(e){Ne.is.desktop===!0&&(ne.push(e),ne.length===1&&document.body.addEventListener("focusin",Lt))}function Re(e){const l=ne.indexOf(e);l>-1&&(ne.splice(l,1),ne.length===0&&document.body.removeEventListener("focusin",Lt))}const{notPassiveCapture:Be}=Qe,se=[];function Me(e){const l=e.target;if(l===void 0||l.nodeType===8||l.classList.contains("no-pointer-events")===!0)return;let t=fe.length-1;for(;t>=0;){const a=fe[t].$;if(a.type.name==="QTooltip"){t--;continue}if(a.type.name!=="QDialog")break;if(a.props.seamless!==!0)return;t--}for(let a=se.length-1;a>=0;a--){const n=se[a];if((n.anchorEl.value===null||n.anchorEl.value.contains(l)===!1)&&(l===document.body||n.innerRef.value!==null&&n.innerRef.value.contains(l)===!1))e.qClickOutside=!0,n.onClickOutside(e);else return}}function Ll(e){se.push(e),se.length===1&&(document.addEventListener("mousedown",Me,Be),document.addEventListener("touchstart",Me,Be))}function st(e){const l=se.findIndex(t=>t===e);l>-1&&(se.splice(l,1),se.length===0&&(document.removeEventListener("mousedown",Me,Be),document.removeEventListener("touchstart",Me,Be)))}let rt,ut;function ct(e){const l=e.split(" ");return l.length!==2?!1:["top","center","bottom"].includes(l[0])!==!0?(console.error("Anchor/Self position must start with one of top/center/bottom"),!1):["left","middle","right","start","end"].includes(l[1])!==!0?(console.error("Anchor/Self position must end with one of left/middle/right/start/end"),!1):!0}function Ol(e){return e?!(e.length!==2||typeof e[0]!="number"||typeof e[1]!="number"):!0}const je={"start#ltr":"left","start#rtl":"right","end#ltr":"right","end#rtl":"left"};["left","middle","right"].forEach(e=>{je[`${e}#ltr`]=e,je[`${e}#rtl`]=e});function dt(e,l){const t=e.split(" ");return{vertical:t[0],horizontal:je[`${t[1]}#${l===!0?"rtl":"ltr"}`]}}function Ql(e,l){let{top:t,left:a,right:n,bottom:r,width:i,height:o}=e.getBoundingClientRect();return l!==void 0&&(t-=l[1],a-=l[0],r+=l[1],n+=l[0],i+=l[0],o+=l[1]),{top:t,bottom:r,height:o,left:a,right:n,width:i,middle:a+(n-a)/2,center:t+(r-t)/2}}function Wl(e,l,t){let{top:a,left:n}=e.getBoundingClientRect();return a+=l.top,n+=l.left,t!==void 0&&(a+=t[1],n+=t[0]),{top:a,bottom:a+1,height:1,left:n,right:n+1,width:1,middle:n,center:a}}function Rl(e,l){return{top:0,center:l/2,bottom:l,left:0,middle:e/2,right:e}}function vt(e,l,t,a){return{top:e[t.vertical]-l[a.vertical],left:e[t.horizontal]-l[a.horizontal]}}function Qt(e,l=0){if(e.targetEl===null||e.anchorEl===null||l>5)return;if(e.targetEl.offsetHeight===0||e.targetEl.offsetWidth===0){setTimeout(()=>{Qt(e,l+1)},10);return}const{targetEl:t,offset:a,anchorEl:n,anchorOrigin:r,selfOrigin:i,absoluteOffset:o,fit:s,cover:d,maxHeight:h,maxWidth:y}=e;if(Ne.is.ios===!0&&window.visualViewport!==void 0){const F=document.body.style,{offsetLeft:g,offsetTop:M}=window.visualViewport;g!==rt&&(F.setProperty("--q-pe-left",g+"px"),rt=g),M!==ut&&(F.setProperty("--q-pe-top",M+"px"),ut=M)}const{scrollLeft:$,scrollTop:u}=t,b=o===void 0?Ql(n,d===!0?[0,0]:a):Wl(n,o,a);Object.assign(t.style,{top:0,left:0,minWidth:null,minHeight:null,maxWidth:y||"100vw",maxHeight:h||"100vh",visibility:"visible"});const{offsetWidth:Q,offsetHeight:f}=t,{elWidth:O,elHeight:j}=s===!0||d===!0?{elWidth:Math.max(b.width,Q),elHeight:d===!0?Math.max(b.height,f):f}:{elWidth:Q,elHeight:f};let x={maxWidth:y,maxHeight:h};(s===!0||d===!0)&&(x.minWidth=b.width+"px",d===!0&&(x.minHeight=b.height+"px")),Object.assign(t.style,x);const v=Rl(O,j);let k=vt(b,v,r,i);if(o===void 0||a===void 0)Le(k,b,v,r,i);else{const{top:F,left:g}=k;Le(k,b,v,r,i);let M=!1;if(k.top!==F){M=!0;const z=2*a[1];b.center=b.top-=z,b.bottom-=z+2}if(k.left!==g){M=!0;const z=2*a[0];b.middle=b.left-=z,b.right-=z+2}M===!0&&(k=vt(b,v,r,i),Le(k,b,v,r,i))}x={top:k.top+"px",left:k.left+"px"},k.maxHeight!==void 0&&(x.maxHeight=k.maxHeight+"px",b.height>k.maxHeight&&(x.minHeight=x.maxHeight)),k.maxWidth!==void 0&&(x.maxWidth=k.maxWidth+"px",b.width>k.maxWidth&&(x.minWidth=x.maxWidth)),Object.assign(t.style,x),t.scrollTop!==u&&(t.scrollTop=u),t.scrollLeft!==$&&(t.scrollLeft=$)}function Le(e,l,t,a,n){const r=t.bottom,i=t.right,o=gl(),s=window.innerHeight-o,d=document.body.clientWidth;if(e.top<0||e.top+r>s)if(n.vertical==="center")e.top=l[a.vertical]>s/2?Math.max(0,s-r):0,e.maxHeight=Math.min(r,s);else if(l[a.vertical]>s/2){const h=Math.min(s,a.vertical==="center"?l.center:a.vertical===n.vertical?l.bottom:l.top);e.maxHeight=Math.min(r,h),e.top=Math.max(0,h-r)}else e.top=Math.max(0,a.vertical==="center"?l.center:a.vertical===n.vertical?l.top:l.bottom),e.maxHeight=Math.min(r,s-e.top);if(e.left<0||e.left+i>d)if(e.maxWidth=Math.min(i,d),n.horizontal==="middle")e.left=l[a.horizontal]>d/2?Math.max(0,d-i):0;else if(l[a.horizontal]>d/2){const h=Math.min(d,a.horizontal==="middle"?l.middle:a.horizontal===n.horizontal?l.right:l.left);e.maxWidth=Math.min(i,h),e.left=Math.max(0,h-e.maxWidth)}else e.left=Math.max(0,a.horizontal==="middle"?l.middle:a.horizontal===n.horizontal?l.left:l.right),e.maxWidth=Math.min(i,d-e.left)}var Wt=ke({name:"QMenu",inheritAttrs:!1,props:{...El,...wt,...Ue,...xt,persistent:Boolean,autoClose:Boolean,separateClosePopup:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,fit:Boolean,cover:Boolean,square:Boolean,anchor:{type:String,validator:ct},self:{type:String,validator:ct},offset:{type:Array,validator:Ol},scrollTarget:{default:void 0},touchPosition:Boolean,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null}},emits:[...Ct,"click","escapeKey"],setup(e,{slots:l,emit:t,attrs:a}){let n=null,r,i,o;const s=ge(),{proxy:d}=s,{$q:h}=d,y=T(null),$=T(!1),u=p(()=>e.persistent!==!0&&e.noRouteDismiss!==!0),b=Ye(e,h),{registerTick:Q,removeTick:f}=Ht(),{registerTimeout:O}=$t(),{transitionProps:j,transitionStyle:x}=Ft(e),{localScrollTarget:v,changeScrollEvent:k,unconfigureScrollTarget:F}=Bl(e,te),{anchorEl:g,canShow:M}=Tl({showing:$}),{hide:z}=Pt({showing:$,canShow:M,handleShow:K,handleHide:be,hideOnRouteChange:u,processOnMount:!0}),{showPortal:U,hidePortal:W,renderPortal:N}=Mt(s,y,ze,"menu"),oe={anchorEl:g,innerRef:y,onClickOutside(S){if(e.persistent!==!0&&$.value===!0)return z(S),(S.type==="touchstart"||S.target.classList.contains("q-dialog__backdrop"))&&zt(S),!0}},ue=p(()=>dt(e.anchor||(e.cover===!0?"center middle":"bottom start"),h.lang.rtl)),ee=p(()=>e.cover===!0?ue.value:dt(e.self||"top start",h.lang.rtl)),c=p(()=>(e.square===!0?" q-menu--square":"")+(b.value===!0?" q-menu--dark q-dark":"")),_=p(()=>e.autoClose===!0?{onClick:Fe}:{}),C=p(()=>$.value===!0&&e.persistent!==!0);G(C,S=>{S===!0?(Dt(H),Ll(oe)):(Te(H),st(oe))});function R(){Et(()=>{let S=y.value;S&&S.contains(document.activeElement)!==!0&&(S=S.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||S.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||S.querySelector("[autofocus], [data-autofocus]")||S,S.focus({preventScroll:!0}))})}function K(S){if(n=e.noRefocus===!1?document.activeElement:null,Ot(q),U(),te(),r=void 0,S!==void 0&&(e.touchPosition||e.contextMenu)){const He=ol(S);if(He.left!==void 0){const{top:Rt,left:jt}=g.value.getBoundingClientRect();r={left:He.left-jt,top:He.top-Rt}}}i===void 0&&(i=G(()=>h.screen.width+"|"+h.screen.height+"|"+e.self+"|"+e.anchor+"|"+h.lang.rtl,Y)),e.noFocus!==!0&&document.activeElement.blur(),Q(()=>{Y(),e.noFocus!==!0&&R()}),O(()=>{h.platform.is.ios===!0&&(o=e.autoClose,y.value.click()),Y(),U(!0),t("show",S)},e.transitionDuration)}function be(S){f(),W(),ce(!0),n!==null&&(S===void 0||S.qClickOutside!==!0)&&(((S&&S.type.indexOf("key")===0?n.closest('[tabindex]:not([tabindex^="-"])'):void 0)||n).focus(),n=null),O(()=>{W(!0),t("hide",S)},e.transitionDuration)}function ce(S){r=void 0,i!==void 0&&(i(),i=void 0),(S===!0||$.value===!0)&&(Re(q),F(),st(oe),Te(H)),S!==!0&&(n=null)}function te(){(g.value!==null||e.scrollTarget!==void 0)&&(v.value=bl(g.value,e.scrollTarget),k(v.value,Y))}function Fe(S){o!==!0?(Bt(d,S),t("click",S)):o=!1}function q(S){C.value===!0&&e.noFocus!==!0&&kt(y.value,S.target)!==!0&&R()}function H(S){t("escapeKey"),z(S)}function Y(){Qt({targetEl:y.value,offset:e.offset,anchorEl:g.value,anchorOrigin:ue.value,selfOrigin:ee.value,absoluteOffset:r,fit:e.fit,cover:e.cover,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function ze(){return B(_e,j.value,()=>$.value===!0?B("div",{role:"menu",...a,ref:y,tabindex:-1,class:["q-menu q-position-engine scroll"+c.value,a.class],style:[a.style,x.value],..._.value},Ke(l.default)):null)}return pe(ce),Object.assign(d,{focus:R,updatePosition:Y}),N}});const jl=I({__name:"promotion-selector",props:{modelValue:{type:Boolean},allegiance:{}},emits:["click","dismiss"],setup(e,{emit:l}){const t=["Q","N","R","B"],a=()=>{l("dismiss")};return(n,r)=>(m(),D(Wt,{cover:"","model-value":n.modelValue,"onUpdate:modelValue":a},{default:E(()=>[w(qt,null,{default:E(()=>[(m(),P(J,null,Z(t,i=>w(Ee,{clickable:"",key:i,class:"q-pa-sm",onClick:o=>l("click",i)},{default:E(()=>[w(Se,{class:"promotion-piece items-center"},{default:E(()=>[w(he,{allegiance:n.allegiance,piece:i,size:92},null,8,["allegiance","piece"])]),_:2},1024)]),_:2},1032,["onClick"])),64))]),_:1})]),_:1},8,["model-value"]))}});var Vl=re(jl,[["__scopeId","data-v-370c2c26"]]);const Nl=I({__name:"capture-selector",props:{modelValue:{type:Boolean},moves:{}},emits:["click","dismiss"],setup(e,{emit:l}){const t=()=>{l("dismiss")};return(a,n)=>(m(),D(Wt,{cover:"","model-value":a.modelValue,"onUpdate:modelValue":t},{default:E(()=>[w(qt,null,{default:E(()=>[a.moves.includes("x")?(m(),D(Ee,{key:0,clickable:"",onClick:n[0]||(n[0]=r=>l("click","capture")),class:"q-py-lg"},{default:E(()=>[w(Se,{class:"items-center"},{default:E(()=>[w(ae,{size:"72px",name:"close"})]),_:1})]),_:1})):L("",!0),a.moves.includes(">")?(m(),D(Ee,{key:1,clickable:"",onClick:n[1]||(n[1]=r=>l("click","challenge")),class:"q-py-lg"},{default:E(()=>[w(Se,{class:"items-center"},{default:E(()=>[w(ae,{size:"64px",name:"arrow_forward_ios"})]),_:1})]),_:1})):L("",!0)]),_:1})]),_:1},8,["model-value"]))}});const Kl={class:"relative-position full-width full-height interaction-layer"},Gl=["onClick"],Ul=I({__name:"interaction-layer",props:{board:{},squareSize:{},ranks:{},files:{},perspective:{},pieceFocus:{}},emits:["execute-node","update-piece-focus","update-highlights"],setup(e,{emit:l}){const t=e,a=T(null),n=p(()=>t.board.enPassantTarget),r=T(null),i=T(null),o=p(()=>t.pieceFocus?t.board.getSquare(t.pieceFocus):null),s=p(()=>t.pieceFocus?t.board.getValidMoves(t.pieceFocus).map(F=>F.kind!=="move"?null:F.to).filter(Boolean):[]),d=v=>{const k=t.board.getSquare(v);return k?Yt(k.allegiance)!==t.perspective:!1},h=v=>s.value.some(k=>k&&V(v,k)),y=(v,k)=>{var g,M;if(k.stopPropagation(),k.preventDefault(),h(v)&&t.pieceFocus&&o.value){if(n.value&&V(n.value,v))l("execute-node",{kind:"move",type:"en-passant",from:t.pieceFocus,to:v}),l("update-piece-focus",null);else if(Ae(v,t.board.activeColour)&&o&&o.value.piece===null){r.value=v;const z=t.board.getSquare(t.pieceFocus);i.value=(g=z==null?void 0:z.allegiance)!=null?g:null}else t.board.getSquare(v)?a.value=v:((M=o.value)==null?void 0:M.piece)==="K"&&Math.abs(t.pieceFocus.file-v.file)>1?l("execute-node",{kind:"move",type:"castle",side:v.file===7?"king":"queen",from:t.pieceFocus,to:v}):l("execute-node",{kind:"move",from:t.pieceFocus,to:v});return}if(d(v))return;const F=t.board.getSquare(v);l("update-piece-focus",F?v:null)},$=(v,k)=>{!t.pieceFocus||(r.value=null,l("execute-node",{kind:"move",type:"promotion",from:t.pieceFocus,to:v,promotionTo:k}),l("update-piece-focus",null))},u=()=>{r.value=null,i.value=null},b=()=>{a.value=null},Q=v=>{!t.pieceFocus||!a.value||(v==="capture"?l("execute-node",{kind:"move",type:"capture",from:t.pieceFocus,to:a.value}):l("execute-node",{kind:"move",type:"allegiance",from:t.pieceFocus,to:a.value}),a.value=null,l("update-piece-focus",null))},f=(v,k)=>{const F=v+1,g=k+1;return t.perspective==="white"?{file:F,rank:9-g}:{file:9-F,rank:g}},O=v=>!t.board.getSquare(v),j=(v,k,F)=>t.board.getValidMoves().some(M=>M.kind==="move"&&V(M.to,F)&&V(M.from,k)&&M.type===v),x=p(()=>{const v=[];return!t.pieceFocus||!a.value||(j("allegiance",t.pieceFocus,a.value)&&v.push(">"),j("capture",t.pieceFocus,a.value)&&v.push("x")),v});return(v,k)=>(m(),P("div",Kl,[(m(!0),P(J,null,Z(v.ranks,(F,g)=>(m(),P("div",{class:"col column row full-width",key:g},[(m(!0),P(J,null,Z(v.files,(M,z)=>{var U,W;return m(),P("div",{key:z,class:"full-height"},[ye((m(),P("div",{class:le(["absolute",{"cursor-pointer":!O(f(z,g))||h(f(z,g)),"cursor-not-allowed":d(f(z,g))&&!o.value}]),onClick:N=>y(f(z,g),N),style:Pe(v.perspective==="white"?{width:`${v.squareSize}px`,height:`${v.squareSize}px`,left:`${(f(z,g).file-1)*v.squareSize}px`,bottom:`${(f(z,g).rank-1)*v.squareSize}px`}:{width:`${v.squareSize}px`,height:`${v.squareSize}px`,right:`${(f(z,g).file-1)*v.squareSize}px`,top:`${(f(z,g).rank-1)*v.squareSize}px`})},[a.value&&A(V)(a.value,f(z,g))?(m(),D(Nl,{key:0,moves:x.value,"model-value":(U=A(V)(a.value,f(z,g)))!=null?U:!1,size:v.squareSize,onClick:Q,onDismiss:b},null,8,["moves","model-value","size"])):L("",!0),i.value!==null&&(A(Ae)(f(z,g),"white")||A(Ae)(f(z,g),"black"))?(m(),D(Vl,{key:1,"model-value":(W=A(V)(r.value,f(z,g)))!=null?W:!1,allegiance:i.value,size:v.squareSize,onClick:N=>$(f(z,g),N),onDismiss:u},null,8,["model-value","allegiance","size","onClick"])):L("",!0)],14,Gl)),[[Ge,!O(f(z,g))&&!d(f(z,g))]])])}),128))]))),128))]))}});var Yl=re(Ul,[["__scopeId","data-v-40d593bc"]]);const Xl={class:"relative-position full-width full-height column no-pointer-events indicators-layer"},Jl=I({__name:"indicators-layer",props:{board:{},ranks:{},files:{},squareSize:{},perspective:{},pieceFocus:{},lastMove:{}},setup(e){const l=e,t=p(()=>l.pieceFocus?l.board.getValidMoves(l.pieceFocus).map(h=>h.kind!=="move"?null:h.to).filter(Boolean):[]),a=s=>t.value.some(d=>d&&V(s,d)),n=s=>!l.board.getSquare(s),r=(s,d)=>{const h=s+1,y=d+1;return l.perspective==="white"?{file:h,rank:9-y}:{file:9-h,rank:y}},i=p(()=>l.board.getCheckMoves()),o=s=>i.value.some(d=>d.kind==="move"&&V(d.to,s));return(s,d)=>(m(),P("div",Xl,[(m(!0),P(J,null,Z(s.ranks,(h,y)=>(m(),P("div",{class:"col column row full-width",key:y},[(m(!0),P(J,null,Z(s.files,($,u)=>{var b,Q;return m(),P("div",{key:u,class:le(["full-height move-placeholder",{even:y%2===0?u%2===0:u%2!==0,focus:A(V)(s.pieceFocus,r(u,y)),show:a(r(u,y)),capture:!n(r(u,y)),target:n(r(u,y)),checked:o(r(u,y)),"last-from":((b=s.lastMove)==null?void 0:b.kind)==="move"&&A(V)(s.lastMove.from,r(u,y)),"last-to":((Q=s.lastMove)==null?void 0:Q.kind)==="move"&&A(V)(s.lastMove.to,r(u,y))}])},null,2)}),128))]))),128))]))}});var Zl=re(Jl,[["__scopeId","data-v-b504cbe8"]]);const Il={class:"relative-position full-width full-height no-pointer-events pieces-layer"},eo=I({__name:"pieces-layer",props:{modelValue:{},squareSize:{},perspective:{}},setup(e){const l=xe();return(t,a)=>(m(),P("div",Il,[(m(!0),P(J,null,Z(t.modelValue,(n,r)=>(m(),P("div",{key:r},[n?(m(),D(he,{key:0,"data-testid":"piece",class:le(["absolute",{"q-pa-xs":A(l).screen.sm||A(l).screen.md,"q-pa-sm":A(l).screen.gt.sm}]),piece:n.piece,allegiance:n.allegiance,size:t.squareSize,style:Pe(t.perspective==="white"?{left:`${(n.file-1)*t.squareSize}px`,bottom:`${(n.rank-1)*t.squareSize}px`}:{right:`${(n.file-1)*t.squareSize}px`,top:`${(n.rank-1)*t.squareSize}px`})},null,8,["class","piece","allegiance","size","style"])):(m(),P("div",{key:1,style:Pe({width:`${t.squareSize}px`,height:`${t.squareSize}px`})},null,4))]))),128))]))}});var to=re(eo,[["__scopeId","data-v-32a0cdca"]]);const lo={class:"absolute full-width full-height"},oo={class:"absolute full-width full-height"},ao={class:"absolute full-width full-height"},io={class:"absolute full-width full-height"},Ho=I({__name:"chess-board",props:{board:{},width:{},perspective:{},playAs:{},roundedBorders:{type:Boolean}},emits:["execute-node"],setup(e,{emit:l}){const t=e,a=p(()=>t.width/8),n=T(null),r=o=>{l("execute-node",o),n.value=null},i=p(()=>{var s;return(s=t.board.getMoveHistoryAst().children.at(-1))!=null?s:null});return(o,s)=>(m(),P("div",{"data-testid":"chess-board",class:le(["relative-position column",{"rounded-borders overflow-hidden":o.roundedBorders}]),style:Pe({width:t.width+"px",height:t.width+"px"})},[X("div",lo,[w(Pl,{ranks:8,files:8,perspective:o.perspective},null,8,["perspective"])]),X("div",oo,[w(Zl,{board:o.board,"square-size":a.value,files:8,ranks:8,perspective:o.perspective,"piece-focus":n.value,"last-move":i.value},null,8,["board","square-size","perspective","piece-focus","last-move"])]),X("div",ao,[w(to,{"model-value":o.board.getSquares(),perspective:t.perspective,"square-size":a.value},null,8,["model-value","perspective","square-size"])]),X("div",io,[w(Yl,{onExecuteNode:r,onUpdatePieceFocus:s[0]||(s[0]=d=>n.value=d),"piece-focus":n.value,board:o.board,"square-size":a.value,files:8,ranks:8,perspective:t.perspective},null,8,["piece-focus","board","square-size","perspective"])])],6))}}),no={xs:8,sm:10,md:14,lg:20,xl:24};var ft=ke({name:"QChip",props:{...Ue,...al,dense:Boolean,icon:String,iconRight:String,iconRemove:String,iconSelected:String,label:[String,Number],color:String,textColor:String,modelValue:{type:Boolean,default:!0},selected:{type:Boolean,default:null},square:Boolean,outline:Boolean,clickable:Boolean,removable:Boolean,removeAriaLabel:String,tabindex:[String,Number],disable:Boolean,ripple:{type:[Boolean,Object],default:!0}},emits:["update:modelValue","update:selected","remove","click"],setup(e,{slots:l,emit:t}){const{proxy:{$q:a}}=ge(),n=Ye(e,a),r=il(e,no),i=p(()=>e.selected===!0||e.icon!==void 0),o=p(()=>e.selected===!0?e.iconSelected||a.iconSet.chip.selected:e.icon),s=p(()=>e.iconRemove||a.iconSet.chip.remove),d=p(()=>e.disable===!1&&(e.clickable===!0||e.selected!==null)),h=p(()=>{const f=e.outline===!0&&e.color||e.textColor;return"q-chip row inline no-wrap items-center"+(e.outline===!1&&e.color!==void 0?` bg-${e.color}`:"")+(f?` text-${f} q-chip--colored`:"")+(e.disable===!0?" disabled":"")+(e.dense===!0?" q-chip--dense":"")+(e.outline===!0?" q-chip--outline":"")+(e.selected===!0?" q-chip--selected":"")+(d.value===!0?" q-chip--clickable cursor-pointer non-selectable q-hoverable":"")+(e.square===!0?" q-chip--square":"")+(n.value===!0?" q-chip--dark q-dark":"")}),y=p(()=>{const f=e.disable===!0?{tabindex:-1,"aria-disabled":"true"}:{tabindex:e.tabindex||0},O={...f,role:"button","aria-hidden":"false","aria-label":e.removeAriaLabel||a.lang.label.remove};return{chip:f,remove:O}});function $(f){f.keyCode===13&&u(f)}function u(f){e.disable||(t("update:selected",!e.selected),t("click",f))}function b(f){(f.keyCode===void 0||f.keyCode===13)&&(zt(f),e.disable===!1&&(t("update:modelValue",!1),t("remove")))}function Q(){const f=[];d.value===!0&&f.push(B("div",{class:"q-focus-helper"})),i.value===!0&&f.push(B(ae,{class:"q-chip__icon q-chip__icon--left",name:o.value}));const O=e.label!==void 0?[B("div",{class:"ellipsis"},[e.label])]:void 0;return f.push(B("div",{class:"q-chip__content col row no-wrap items-center q-anchor--skip"},sl(l.default,O))),e.iconRight&&f.push(B(ae,{class:"q-chip__icon q-chip__icon--right",name:e.iconRight})),e.removable===!0&&f.push(B(ae,{class:"q-chip__icon q-chip__icon--remove cursor-pointer",name:s.value,...y.value.remove,onClick:b,onKeyup:b})),f}return()=>{if(e.modelValue===!1)return;const f={class:h.value,style:r.value};return d.value===!0&&Object.assign(f,y.value.chip,{onClick:u,onKeyup:$}),nl("div",f,Q(),"ripple",e.ripple!==!1&&e.disable!==!0,()=>[[Ge,e.ripple]])}}});const ht=["vertical","horizontal"],Oe={vertical:{offset:"offsetY",scroll:"scrollTop",dir:"down",dist:"y"},horizontal:{offset:"offsetX",scroll:"scrollLeft",dir:"right",dist:"x"}},mt={prevent:!0,mouse:!0,mouseAllDir:!0},pt=e=>e>=250?50:Math.ceil(e/5);var so=ke({name:"QScrollArea",props:{...Ue,thumbStyle:Object,verticalThumbStyle:Object,horizontalThumbStyle:Object,barStyle:[Array,String,Object],verticalBarStyle:[Array,String,Object],horizontalBarStyle:[Array,String,Object],contentStyle:[Array,String,Object],contentActiveStyle:[Array,String,Object],delay:{type:[String,Number],default:1e3},visible:{type:Boolean,default:null},tabindex:[String,Number],onScroll:Function},setup(e,{slots:l,emit:t}){const a=T(!1),n=T(!1),r=T(!1),i={vertical:T(0),horizontal:T(0)},o={vertical:{ref:T(null),position:T(0),size:T(0)},horizontal:{ref:T(null),position:T(0),size:T(0)}},{proxy:s}=ge(),d=Ye(e,s.$q);let h=null,y;const $=T(null),u=p(()=>"q-scrollarea"+(d.value===!0?" q-scrollarea--dark":""));o.vertical.percentage=p(()=>{const c=o.vertical.size.value-i.vertical.value;if(c<=0)return 0;const _=we(o.vertical.position.value/c,0,1);return Math.round(_*1e4)/1e4}),o.vertical.thumbHidden=p(()=>(e.visible===null?r.value:e.visible)!==!0&&a.value===!1&&n.value===!1||o.vertical.size.value<=i.vertical.value+1),o.vertical.thumbStart=p(()=>o.vertical.percentage.value*(i.vertical.value-o.vertical.thumbSize.value)),o.vertical.thumbSize=p(()=>Math.round(we(i.vertical.value*i.vertical.value/o.vertical.size.value,pt(i.vertical.value),i.vertical.value))),o.vertical.style=p(()=>({...e.thumbStyle,...e.verticalThumbStyle,top:`${o.vertical.thumbStart.value}px`,height:`${o.vertical.thumbSize.value}px`})),o.vertical.thumbClass=p(()=>"q-scrollarea__thumb q-scrollarea__thumb--v absolute-right"+(o.vertical.thumbHidden.value===!0?" q-scrollarea__thumb--invisible":"")),o.vertical.barClass=p(()=>"q-scrollarea__bar q-scrollarea__bar--v absolute-right"+(o.vertical.thumbHidden.value===!0?" q-scrollarea__bar--invisible":"")),o.horizontal.percentage=p(()=>{const c=o.horizontal.size.value-i.horizontal.value;if(c<=0)return 0;const _=we(Math.abs(o.horizontal.position.value)/c,0,1);return Math.round(_*1e4)/1e4}),o.horizontal.thumbHidden=p(()=>(e.visible===null?r.value:e.visible)!==!0&&a.value===!1&&n.value===!1||o.horizontal.size.value<=i.horizontal.value+1),o.horizontal.thumbStart=p(()=>o.horizontal.percentage.value*(i.horizontal.value-o.horizontal.thumbSize.value)),o.horizontal.thumbSize=p(()=>Math.round(we(i.horizontal.value*i.horizontal.value/o.horizontal.size.value,pt(i.horizontal.value),i.horizontal.value))),o.horizontal.style=p(()=>({...e.thumbStyle,...e.horizontalThumbStyle,[s.$q.lang.rtl===!0?"right":"left"]:`${o.horizontal.thumbStart.value}px`,width:`${o.horizontal.thumbSize.value}px`})),o.horizontal.thumbClass=p(()=>"q-scrollarea__thumb q-scrollarea__thumb--h absolute-bottom"+(o.horizontal.thumbHidden.value===!0?" q-scrollarea__thumb--invisible":"")),o.horizontal.barClass=p(()=>"q-scrollarea__bar q-scrollarea__bar--h absolute-bottom"+(o.horizontal.thumbHidden.value===!0?" q-scrollarea__bar--invisible":""));const b=p(()=>o.vertical.thumbHidden.value===!0&&o.horizontal.thumbHidden.value===!0?e.contentStyle:e.contentActiveStyle),Q=[[ot,c=>{g(c,"vertical")},void 0,{vertical:!0,...mt}]],f=[[ot,c=>{g(c,"horizontal")},void 0,{horizontal:!0,...mt}]];function O(){const c={};return ht.forEach(_=>{const C=o[_];c[_+"Position"]=C.position.value,c[_+"Percentage"]=C.percentage.value,c[_+"Size"]=C.size.value,c[_+"ContainerSize"]=i[_].value}),c}const j=rl(()=>{const c=O();c.ref=s,t("scroll",c)},0);function x(c,_,C){if(ht.includes(c)===!1){console.error("[QScrollArea]: wrong first param of setScrollPosition (vertical/horizontal)");return}(c==="vertical"?lt:De)($.value,_,C)}function v({height:c,width:_}){let C=!1;i.vertical.value!==c&&(i.vertical.value=c,C=!0),i.horizontal.value!==_&&(i.horizontal.value=_,C=!0),C===!0&&W()}function k({position:c}){let _=!1;o.vertical.position.value!==c.top&&(o.vertical.position.value=c.top,_=!0),o.horizontal.position.value!==c.left&&(o.horizontal.position.value=c.left,_=!0),_===!0&&W()}function F({height:c,width:_}){o.horizontal.size.value!==_&&(o.horizontal.size.value=_,W()),o.vertical.size.value!==c&&(o.vertical.size.value=c,W())}function g(c,_){const C=o[_];if(c.isFirst===!0){if(C.thumbHidden.value===!0)return;y=C.position.value,n.value=!0}else if(n.value!==!0)return;c.isFinal===!0&&(n.value=!1);const R=Oe[_],K=i[_].value,be=(C.size.value-K)/(K-C.thumbSize.value),ce=c.distance[R.dist],te=y+(c.direction===R.dir?1:-1)*ce*be;N(te,_)}function M(c,_){const C=o[_];if(C.thumbHidden.value!==!0){const R=c[Oe[_].offset];if(R<C.thumbStart.value||R>C.thumbStart.value+C.thumbSize.value){const K=R-C.thumbSize.value/2;N(K/i[_].value*C.size.value,_)}C.ref.value!==null&&C.ref.value.dispatchEvent(new MouseEvent(c.type,c))}}function z(c){M(c,"vertical")}function U(c){M(c,"horizontal")}function W(){a.value=!0,h!==null&&clearTimeout(h),h=setTimeout(()=>{h=null,a.value=!1},e.delay),e.onScroll!==void 0&&j()}function N(c,_){$.value[Oe[_].scroll]=c}function oe(){r.value=!0}function ue(){r.value=!1}let ee=null;return G(()=>s.$q.lang.rtl,c=>{$.value!==null&&De($.value,Math.abs(o.horizontal.position.value)*(c===!0?-1:1))}),St(()=>{ee={top:o.vertical.position.value,left:o.horizontal.position.value}}),ul(()=>{if(ee===null)return;const c=$.value;c!==null&&(De(c,ee.left),lt(c,ee.top))}),pe(j.cancel),Object.assign(s,{getScrollTarget:()=>$.value,getScroll:O,getScrollPosition:()=>({top:o.vertical.position.value,left:o.horizontal.position.value}),getScrollPercentage:()=>({top:o.vertical.percentage.value,left:o.horizontal.percentage.value}),setScrollPosition:x,setScrollPercentage(c,_,C){x(c,_*(o[c].size.value-i[c].value)*(c==="horizontal"&&s.$q.lang.rtl===!0?-1:1),C)}}),()=>B("div",{class:u.value,onMouseenter:oe,onMouseleave:ue},[B("div",{ref:$,class:"q-scrollarea__container scroll relative-position fit hide-scrollbar",tabindex:e.tabindex!==void 0?e.tabindex:void 0},[B("div",{class:"q-scrollarea__content absolute",style:b.value},cl(l.default,[B(tt,{debounce:0,onResize:F})])),B(_l,{axis:"both",onScroll:k})]),B(tt,{debounce:0,onResize:v}),B("div",{class:o.vertical.barClass.value,style:[e.barStyle,e.verticalBarStyle],"aria-hidden":"true",onMousedown:z}),B("div",{class:o.horizontal.barClass.value,style:[e.barStyle,e.horizontalBarStyle],"aria-hidden":"true",onMousedown:U}),ye(B("div",{ref:o.vertical.ref,class:o.vertical.thumbClass.value,style:o.vertical.style.value,"aria-hidden":"true"}),Q),ye(B("div",{ref:o.horizontal.ref,class:o.horizontal.thumbClass.value,style:o.horizontal.style.value,"aria-hidden":"true"}),f)])}});const Xe=e=>(dl("data-v-8ab85e04"),e=e(),vl(),e),ro=Xe(()=>X("div",{class:"text-h6"},"Your turn!",-1)),uo=Xe(()=>X("div",{class:"text-h6"},"Waiting for opponent...",-1)),co=Xe(()=>X("div",{class:"spacer col"},null,-1)),vo={"data-testid":"afen"},fo={"data-testid":"move-history"},ho={key:0,class:"col"},mo={key:0,class:"col"},po=I({__name:"game-sidebar",props:{moveHistory:{},activeColour:{},ownColour:{},afen:{}},setup(e){const l=e,t=p(()=>{const i=[];return l.moveHistory.children.forEach(o=>{const s=i.at(-1);if(!s||s.length!==1){i.push([o]);return}s.push(o)}),i}),a=T(null);G(t,()=>{!a.value||a.value.setScrollPosition("vertical",t.value.length*36,1e3)}),yt(()=>{!a.value||a.value.setScrollPosition("vertical",t.value.length*36,1e3)});const n=xe(),r=()=>{if(!!l.afen)try{navigator.clipboard.writeText(l.afen),n.notify({position:"bottom-right",timeout:4e3,message:"AFEN copied to clipboard",icon:"content_copy"})}catch{n.notify({position:"bottom-right",timeout:4e3,message:"Could not write to clipboard",icon:"close",iconColor:"red"})}};return(i,o)=>(m(),D(Tt,{flat:"",bordered:"",class:"q-ma-md full-height column justify-between","data-testid":"game-sidebar"},{default:E(()=>[w(_e,{mode:"out-in"},{default:E(()=>[i.activeColour===i.ownColour?(m(),D(ve,{key:0,class:"bg-primary text-white q-mb-md"},{default:E(()=>[ro]),_:1})):(m(),D(ve,{key:1,class:"bg-grey text-black q-mb-md"},{default:E(()=>[uo]),_:1}))]),_:1}),co,X("div",vo,[w(We),ye((m(),D(Ee,{clickable:"",onClick:r},{default:E(()=>[w(Se,{class:"q-mt-sm q-mb-sm"},{default:E(()=>[w(it,null,{default:E(()=>[qe("AFEN")]),_:1}),w(it,{caption:"",lines:"2"},{default:E(()=>[qe(de(i.afen),1)]),_:1})]),_:1}),w(Se,{side:""},{default:E(()=>[w(ae,{name:"edit"})]),_:1})]),_:1})),[[Ge]])]),X("div",fo,[w(We),w(A(so),{style:{height:"500px"},ref_key:"moveHistoryScrollArea",ref:a},{default:E(()=>[(m(!0),P(J,null,Z(t.value,(s,d)=>(m(),D(ve,{key:d,horizontal:"",class:le(["row q-py-none q-mx-md",{"q-pt-md":d===0,"q-pb-md":d===t.value.length-1}])},{default:E(()=>[s[0]?(m(),P("div",ho,[w(ft,{ripple:!1,class:le(["white-move",{highlight:s[0].kind!=="move"}])},{default:E(()=>[s[0].kind==="move"&&s[0].piece?(m(),D(he,{key:0,piece:s[0].piece,allegiance:3,size:24},null,8,["piece"])):L("",!0),qe(" "+de(A(nt).writeNode(s[0])),1)]),_:2},1032,["class"])])):L("",!0),w(_e,{mode:"out-in"},{default:E(()=>[s[1]?(m(),P("div",mo,[w(ft,{ripple:!1,class:le(["black-move",{highlight:s[1].kind!=="move"}])},{default:E(()=>[s[1].kind==="move"&&s[1].piece?(m(),D(he,{key:0,piece:s[1].piece,allegiance:0,size:24},null,8,["piece"])):L("",!0),qe(" "+de(A(nt).writeNode(s[1])),1)]),_:2},1032,["class"])])):L("",!0)]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1},512)])]),_:1}))}});var Ao=re(po,[["__scopeId","data-v-8ab85e04"]]),go=ke({name:"QCardActions",props:{...fl,vertical:Boolean},setup(e,{slots:l}){const t=hl(e),a=p(()=>`q-card__actions ${t.value} q-card__actions--${e.vertical===!0?"vert column":"horiz row"}`);return()=>B("div",{class:a.value},Ke(l.default))}});let Ce=0;const bo={standard:"fixed-full flex-center",top:"fixed-top justify-center",bottom:"fixed-bottom justify-center",right:"fixed-right items-center",left:"fixed-left items-center"},gt={standard:["scale","scale"],top:["slide-down","slide-up"],bottom:["slide-up","slide-down"],right:["slide-left","slide-right"],left:["slide-right","slide-left"]};var _o=ke({name:"QDialog",inheritAttrs:!1,props:{...wt,...xt,transitionShow:String,transitionHide:String,persistent:Boolean,autoClose:Boolean,allowFocusOutside:Boolean,noEscDismiss:Boolean,noBackdropDismiss:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,noShake:Boolean,seamless:Boolean,maximized:Boolean,fullWidth:Boolean,fullHeight:Boolean,square:Boolean,position:{type:String,default:"standard",validator:e=>e==="standard"||["top","bottom","left","right"].includes(e)}},emits:[...Ct,"shake","click","escapeKey"],setup(e,{slots:l,emit:t,attrs:a}){const n=ge(),r=T(null),i=T(!1),o=T(!1);let s=null,d=null,h,y;const $=p(()=>e.persistent!==!0&&e.noRouteDismiss!==!0&&e.seamless!==!0),{preventBodyScroll:u}=Sl(),{registerTimeout:b}=$t(),{registerTick:Q,removeTick:f}=Ht(),{transitionProps:O,transitionStyle:j}=Ft(e,()=>gt[e.position][0],()=>gt[e.position][1]),{showPortal:x,hidePortal:v,portalIsAccessible:k,renderPortal:F}=Mt(n,r,Fe,"dialog"),{hide:g}=Pt({showing:i,hideOnRouteChange:$,handleShow:ue,handleHide:ee,processOnMount:!0}),{addToHistory:M,removeFromHistory:z}=yl(i,g,$),U=p(()=>`q-dialog__inner flex no-pointer-events q-dialog__inner--${e.maximized===!0?"maximized":"minimized"} q-dialog__inner--${e.position} ${bo[e.position]}`+(o.value===!0?" q-dialog__inner--animating":"")+(e.fullWidth===!0?" q-dialog__inner--fullwidth":"")+(e.fullHeight===!0?" q-dialog__inner--fullheight":"")+(e.square===!0?" q-dialog__inner--square":"")),W=p(()=>i.value===!0&&e.seamless!==!0),N=p(()=>e.autoClose===!0?{onClick:be}:{}),oe=p(()=>[`q-dialog fullscreen no-pointer-events q-dialog--${W.value===!0?"modal":"seamless"}`,a.class]);G(()=>e.maximized,q=>{i.value===!0&&K(q)}),G(W,q=>{u(q),q===!0?(Ot(te),Dt(C)):(Re(te),Te(C))});function ue(q){M(),d=e.noRefocus===!1&&document.activeElement!==null?document.activeElement:null,K(e.maximized),x(),o.value=!0,e.noFocus!==!0?(document.activeElement!==null&&document.activeElement.blur(),Q(c)):f(),b(()=>{if(n.proxy.$q.platform.is.ios===!0){if(e.seamless!==!0&&document.activeElement){const{top:H,bottom:Y}=document.activeElement.getBoundingClientRect(),{innerHeight:ze}=window,S=window.visualViewport!==void 0?window.visualViewport.height:ze;H>0&&Y>S/2&&(document.scrollingElement.scrollTop=Math.min(document.scrollingElement.scrollHeight-S,Y>=ze?1/0:Math.ceil(document.scrollingElement.scrollTop+Y-S/2))),document.activeElement.scrollIntoView()}y=!0,r.value.click(),y=!1}x(!0),o.value=!1,t("show",q)},e.transitionDuration)}function ee(q){f(),z(),R(!0),o.value=!0,v(),d!==null&&(((q&&q.type.indexOf("key")===0?d.closest('[tabindex]:not([tabindex^="-"])'):void 0)||d).focus(),d=null),b(()=>{v(!0),o.value=!1,t("hide",q)},e.transitionDuration)}function c(q){Et(()=>{let H=r.value;H===null||H.contains(document.activeElement)===!0||(H=(q!==""?H.querySelector(q):null)||H.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||H.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||H.querySelector("[autofocus], [data-autofocus]")||H,H.focus({preventScroll:!0}))})}function _(q){q&&typeof q.focus=="function"?q.focus({preventScroll:!0}):c(),t("shake");const H=r.value;H!==null&&(H.classList.remove("q-animate--scale"),H.classList.add("q-animate--scale"),s!==null&&clearTimeout(s),s=setTimeout(()=>{s=null,r.value!==null&&(H.classList.remove("q-animate--scale"),c())},170))}function C(){e.seamless!==!0&&(e.persistent===!0||e.noEscDismiss===!0?e.maximized!==!0&&e.noShake!==!0&&_():(t("escapeKey"),g()))}function R(q){s!==null&&(clearTimeout(s),s=null),(q===!0||i.value===!0)&&(K(!1),e.seamless!==!0&&(u(!1),Re(te),Te(C))),q!==!0&&(d=null)}function K(q){q===!0?h!==!0&&(Ce<1&&document.body.classList.add("q-body--dialog"),Ce++,h=!0):h===!0&&(Ce<2&&document.body.classList.remove("q-body--dialog"),Ce--,h=!1)}function be(q){y!==!0&&(g(q),t("click",q))}function ce(q){e.persistent!==!0&&e.noBackdropDismiss!==!0?g(q):e.noShake!==!0&&_()}function te(q){e.allowFocusOutside!==!0&&k.value===!0&&kt(r.value,q.target)!==!0&&c('[tabindex]:not([tabindex="-1"])')}Object.assign(n.proxy,{focus:c,shake:_,__updateRefocusTarget(q){d=q||null}}),pe(R);function Fe(){return B("div",{role:"dialog","aria-modal":W.value===!0?"true":"false",...a,class:oe.value},[B(_e,{name:"q-transition--fade",appear:!0},()=>W.value===!0?B("div",{class:"q-dialog__backdrop fixed-full",style:j.value,"aria-hidden":"true",tabindex:-1,onClick:ce}):null),B(_e,O.value,()=>i.value===!0?B("div",{ref:r,class:U.value,style:j.value,tabindex:-1,...N.value},Ke(l.default)):null)])}return F}});function bt(e){if(e===!1)return 0;if(e===!0||e===void 0)return 1;const l=parseInt(e,10);return isNaN(l)?0:l}var yo=ml({name:"close-popup",beforeMount(e,{value:l}){const t={depth:bt(l),handler(a){t.depth!==0&&setTimeout(()=>{const n=Ml(e);n!==void 0&&xl(n,a,t.depth)})},handlerKey(a){Ve(a,13)===!0&&t.handler(a)}};e.__qclosepopup=t,e.addEventListener("click",t.handler),e.addEventListener("keyup",t.handlerKey)},updated(e,{value:l,oldValue:t}){l!==t&&(e.__qclosepopup.depth=bt(l))},beforeUnmount(e){const l=e.__qclosepopup;e.removeEventListener("click",l.handler),e.removeEventListener("keyup",l.handlerKey),delete e.__qclosepopup}});const So={key:0},ko={key:1},zo={key:2},qo={key:0,class:"text-subtitle1 text-center"},wo=I({__name:"game-over-dialog",props:{node:{}},setup(e){return(l,t)=>(m(),D(_o,{"model-value":!0,persistent:"",position:"bottom"},{default:E(()=>[w(Tt,{class:"my-card game-over-dialog"},{default:E(()=>[w(ve,{class:"bg-primary text-h5 row justify-between"},{default:E(()=>[l.node.outcome==="white"?(m(),P("span",So,"White wins!")):L("",!0),l.node.outcome==="black"?(m(),P("span",ko,"Black wins!")):L("",!0),l.node.outcome==="draw"?(m(),P("span",zo,"Draw!")):L("",!0),ye(w(et,{icon:"close",flat:"",round:"",dense:""},null,512),[[yo]])]),_:1}),w(ve,{class:"row justify-center"},{default:E(()=>[l.node.outcome==="white"?(m(),D(he,{key:0,allegiance:A(Je).White,piece:"K",size:96},null,8,["allegiance"])):L("",!0),l.node.outcome==="black"?(m(),D(he,{key:1,allegiance:A(Je).Black,piece:"K",size:96},null,8,["allegiance"])):L("",!0),l.node.outcome==="draw"?(m(),D(ae,{key:2,name:"balance",size:"96px",color:"grey"})):L("",!0)]),_:1}),w(ve,{class:"q-pt-none"},{default:E(()=>[l.node.reason?(m(),P("div",qo,de(l.node.reason),1)):L("",!0)]),_:1}),w(We),w(go,{align:"right"},{default:E(()=>[w(et,{color:"secondary","text-color":"primary",label:"New game",to:"/play"})]),_:1})]),_:1})]),_:1}))}});var Do=re(wo,[["__scopeId","data-v-fc28b0e2"]]);const Lo=()=>{const e=xe();return p(()=>{let l=e.screen.width;return e.screen.gt.xs&&(l=e.screen.width-65),e.screen.gt.sm&&(l=e.screen.sizes.sm),e.screen.gt.md&&(l=e.screen.sizes.md-265),e.screen.gt.lg&&(l=e.screen.sizes.lg-265),Math.min(l,e.screen.height)})};export{Ao as G,Ho as _,Do as a,Lo as u};
//# sourceMappingURL=board-size.5e61317b.js.map
