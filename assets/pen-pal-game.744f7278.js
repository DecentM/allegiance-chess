import{Q as n}from"./chess-piece.67c09ac1.js";import{b as y,a as l}from"./QList.278d4855.js";import{A as g,K as _,ar as x,r as b,a as k,k as C,w as H,B as i,C as m,D as o,G as t,N as a,H as v,I,u as N,P as w}from"./index.393a4629.js";import{u as O}from"./use-quasar.0fd855dc.js";import{u as q,_ as A,C as Q,G as B,a as M}from"./board-worker.1232f860.js";import{H as c}from"./hex.88f37ffd.js";import"./use-dark.48e385ad.js";import"./QCard.0e215a11.js";import"./QScrollObserver.fbd8f90c.js";import"./focus-manager.202af5b7.js";import"./QSeparator.3a962b35.js";import"./notify.f70e1930.js";import"./exports.37caa241.js";const j=g({__name:"pen-pal-game",setup(S){const u=_(),p=x(),d=b([]),e=q({autoplayFor:d}),s=k(()=>{try{const r=Array.isArray(u.params.state)?u.params.state[0]:u.params.state;return JSON.parse(c.hexToUtf8(r))}catch{return{afen:"",history:""}}});C(()=>{e.reset(),s.value.afen&&e.importAfen(s.value.afen),s.value.history&&e.importMoveHistory(s.value.history)});const f=r=>{e.executeMoveIndex(r)};H(e.loading,r=>{r||p.push({path:`/play/pen-pal/${c.utf8ToHex(JSON.stringify({afen:e.afen.value,history:e.moveHistory.value}))}`})});const h=O();return(r,G)=>(i(),m(A,null,{board:o(()=>[t(Q,{onExecuteNodeIndex:f,board:a(e),perspective:a(e).activeColour.value,"active-colour":a(e).activeColour.value,"check-moves":a(e).checkMoves.value,"en-passant-target":a(e).enPassantTarget.value,"move-history-ast":a(e).moveHistoryAst.value,squares:a(e).squares.value,"valid-moves":a(e).validMoves.value,"play-as":["white","black"],"rounded-borders":a(h).screen.gt.xs,loading:a(e).loading.value},null,8,["board","perspective","active-colour","check-moves","en-passant-target","move-history-ast","squares","valid-moves","rounded-borders","loading"])]),sidebar:o(()=>[t(B,{"move-history":a(e).moveHistoryAst.value,"active-colour":a(e).activeColour.value,"own-colour":a(e).activeColour.value,afen:a(e).afen.value,"game-over":a(e).gameOver.value},{default:o(()=>[t(y,null,{default:o(()=>[t(l,{class:"q-mt-sm q-mb-sm"},{default:o(()=>[t(n,null,{default:o(()=>[v("Opening")]),_:1}),t(n,{caption:"",lines:"2"},{default:o(()=>[v(I(a(e).opening.value||"unknown"),1)]),_:1})]),_:1}),t(l,{side:""},{default:o(()=>[t(N,{name:"book"})]),_:1})]),_:1})]),_:1},8,["move-history","active-colour","own-colour","afen","game-over"])]),default:o(()=>[a(e).gameOver.value?(i(),m(M,{key:0,node:a(e).gameOver.value},null,8,["node"])):w("",!0)]),_:1}))}});export{j as default};
//# sourceMappingURL=pen-pal-game.744f7278.js.map
