import{Q as tt,a as F}from"./QCard.7b376b72.js";import{A as et,K as nt,ak as rt,a as H,r as ot,w as it,k as at,B as P,C as R,D as E,G as $,aj as ut,M as I,N as D,O as st}from"./index.b271fcf9.js";import{u as ct}from"./use-quasar.70ee791f.js";import{d as _,P as O,b as ft,A as lt,B as xt}from"./board.c16f8167.js";import{u as vt,_ as pt,G as ht,a as mt}from"./board-size.5e61317b.js";import{H as T}from"./hex.3d30e428.js";import{a as gt,u as yt}from"./board-audio.8be8d5e3.js";import"./use-dark.fb55bdf3.js";import"./QList.6317c7be.js";import"./QScrollObserver.751e0e8d.js";import"./focus-manager.202af5b7.js";import"./chess-piece.049befa3.js";var Q={exports:{}};(function(h){(function(m,s,f){function x(t){var r=this,o=a();r.next=function(){var e=2091639*r.s0+r.c*23283064365386963e-26;return r.s0=r.s1,r.s1=r.s2,r.s2=e-(r.c=e|0)},r.c=1,r.s0=o(" "),r.s1=o(" "),r.s2=o(" "),r.s0-=o(t),r.s0<0&&(r.s0+=1),r.s1-=o(t),r.s1<0&&(r.s1+=1),r.s2-=o(t),r.s2<0&&(r.s2+=1),o=null}function c(t,r){return r.c=t.c,r.s0=t.s0,r.s1=t.s1,r.s2=t.s2,r}function l(t,r){var o=new x(t),e=r&&r.state,n=o.next;return n.int32=function(){return o.next()*4294967296|0},n.double=function(){return n()+(n()*2097152|0)*11102230246251565e-32},n.quick=n,e&&(typeof e=="object"&&c(e,o),n.state=function(){return c(o,{})}),n}function a(){var t=4022871197,r=function(o){o=String(o);for(var e=0;e<o.length;e++){t+=o.charCodeAt(e);var n=.02519603282416938*t;t=n>>>0,n-=t,n*=t,t=n>>>0,n-=t,t+=n*4294967296}return(t>>>0)*23283064365386963e-26};return r}s&&s.exports?s.exports=l:f&&f.amd?f(function(){return l}):this.alea=l})(_,h,!1)})(Q);var U={exports:{}};(function(h){(function(m,s,f){function x(a){var t=this,r="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},a===(a|0)?t.x=a:r+=a;for(var o=0;o<r.length+64;o++)t.x^=r.charCodeAt(o)|0,t.next()}function c(a,t){return t.x=a.x,t.y=a.y,t.z=a.z,t.w=a.w,t}function l(a,t){var r=new x(a),o=t&&t.state,e=function(){return(r.next()>>>0)/4294967296};return e.double=function(){do var n=r.next()>>>11,i=(r.next()>>>0)/4294967296,u=(n+i)/(1<<21);while(u===0);return u},e.int32=r.next,e.quick=e,o&&(typeof o=="object"&&c(o,r),e.state=function(){return c(r,{})}),e}s&&s.exports?s.exports=l:f&&f.amd?f(function(){return l}):this.xor128=l})(_,h,!1)})(U);var Y={exports:{}};(function(h){(function(m,s,f){function x(a){var t=this,r="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^(e^e<<1))|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,a===(a|0)?t.x=a:r+=a;for(var o=0;o<r.length+64;o++)t.x^=r.charCodeAt(o)|0,o==r.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function c(a,t){return t.x=a.x,t.y=a.y,t.z=a.z,t.w=a.w,t.v=a.v,t.d=a.d,t}function l(a,t){var r=new x(a),o=t&&t.state,e=function(){return(r.next()>>>0)/4294967296};return e.double=function(){do var n=r.next()>>>11,i=(r.next()>>>0)/4294967296,u=(n+i)/(1<<21);while(u===0);return u},e.int32=r.next,e.quick=e,o&&(typeof o=="object"&&c(o,r),e.state=function(){return c(r,{})}),e}s&&s.exports?s.exports=l:f&&f.amd?f(function(){return l}):this.xorwow=l})(_,h,!1)})(Y);var K={exports:{}};(function(h){(function(m,s,f){function x(a){var t=this;t.next=function(){var o=t.x,e=t.i,n,i;return n=o[e],n^=n>>>7,i=n^n<<24,n=o[e+1&7],i^=n^n>>>10,n=o[e+3&7],i^=n^n>>>3,n=o[e+4&7],i^=n^n<<7,n=o[e+7&7],n=n^n<<13,i^=n^n<<9,o[e]=i,t.i=e+1&7,i};function r(o,e){var n,i=[];if(e===(e|0))i[0]=e;else for(e=""+e,n=0;n<e.length;++n)i[n&7]=i[n&7]<<15^e.charCodeAt(n)+i[n+1&7]<<13;for(;i.length<8;)i.push(0);for(n=0;n<8&&i[n]===0;++n);for(n==8?i[7]=-1:i[n],o.x=i,o.i=0,n=256;n>0;--n)o.next()}r(t,a)}function c(a,t){return t.x=a.x.slice(),t.i=a.i,t}function l(a,t){a==null&&(a=+new Date);var r=new x(a),o=t&&t.state,e=function(){return(r.next()>>>0)/4294967296};return e.double=function(){do var n=r.next()>>>11,i=(r.next()>>>0)/4294967296,u=(n+i)/(1<<21);while(u===0);return u},e.int32=r.next,e.quick=e,o&&(o.x&&c(o,r),e.state=function(){return c(r,{})}),e}s&&s.exports?s.exports=l:f&&f.amd?f(function(){return l}):this.xorshift7=l})(_,h,!1)})(K);var W={exports:{}};(function(h){(function(m,s,f){function x(a){var t=this;t.next=function(){var o=t.w,e=t.X,n=t.i,i,u;return t.w=o=o+1640531527|0,u=e[n+34&127],i=e[n=n+1&127],u^=u<<13,i^=i<<17,u^=u>>>15,i^=i>>>12,u=e[n]=u^i,t.i=n,u+(o^o>>>16)|0};function r(o,e){var n,i,u,g,N,b=[],B=128;for(e===(e|0)?(i=e,e=null):(e=e+"\0",i=0,B=Math.max(B,e.length)),u=0,g=-32;g<B;++g)e&&(i^=e.charCodeAt((g+32)%e.length)),g===0&&(N=i),i^=i<<10,i^=i>>>15,i^=i<<4,i^=i>>>13,g>=0&&(N=N+1640531527|0,n=b[g&127]^=i+N,u=n==0?u+1:0);for(u>=128&&(b[(e&&e.length||0)&127]=-1),u=127,g=4*128;g>0;--g)i=b[u+34&127],n=b[u=u+1&127],i^=i<<13,n^=n<<17,i^=i>>>15,n^=n>>>12,b[u]=i^n;o.w=N,o.X=b,o.i=u}r(t,a)}function c(a,t){return t.i=a.i,t.w=a.w,t.X=a.X.slice(),t}function l(a,t){a==null&&(a=+new Date);var r=new x(a),o=t&&t.state,e=function(){return(r.next()>>>0)/4294967296};return e.double=function(){do var n=r.next()>>>11,i=(r.next()>>>0)/4294967296,u=(n+i)/(1<<21);while(u===0);return u},e.int32=r.next,e.quick=e,o&&(o.X&&c(o,r),e.state=function(){return c(r,{})}),e}s&&s.exports?s.exports=l:f&&f.amd?f(function(){return l}):this.xor4096=l})(_,h,!1)})(W);var J={exports:{}};(function(h){(function(m,s,f){function x(a){var t=this,r="";t.next=function(){var e=t.b,n=t.c,i=t.d,u=t.a;return e=e<<25^e>>>7^n,n=n-i|0,i=i<<24^i>>>8^u,u=u-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-i|0,t.d=i<<16^n>>>16^u,t.a=u-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,a===Math.floor(a)?(t.a=a/4294967296|0,t.b=a|0):r+=a;for(var o=0;o<r.length+20;o++)t.b^=r.charCodeAt(o)|0,t.next()}function c(a,t){return t.a=a.a,t.b=a.b,t.c=a.c,t.d=a.d,t}function l(a,t){var r=new x(a),o=t&&t.state,e=function(){return(r.next()>>>0)/4294967296};return e.double=function(){do var n=r.next()>>>11,i=(r.next()>>>0)/4294967296,u=(n+i)/(1<<21);while(u===0);return u},e.int32=r.next,e.quick=e,o&&(typeof o=="object"&&c(o,r),e.state=function(){return c(r,{})}),e}s&&s.exports?s.exports=l:f&&f.amd?f(function(){return l}):this.tychei=l})(_,h,!1)})(J);var L={exports:{}};(function(h){(function(m,s,f){var x=256,c=6,l=52,a="random",t=f.pow(x,c),r=f.pow(2,l),o=r*2,e=x-1,n;function i(v,p,d){var w=[];p=p==!0?{entropy:!0}:p||{};var y=b(N(p.entropy?[v,X(s)]:v==null?B():v,3),w),A=new u(w),C=function(){for(var S=A.g(c),k=t,M=0;S<r;)S=(S+M)*x,k*=x,M=A.g(1);for(;S>=o;)S/=2,k/=2,M>>>=1;return(S+M)/k};return C.int32=function(){return A.g(4)|0},C.quick=function(){return A.g(4)/4294967296},C.double=C,b(X(A.S),s),(p.pass||d||function(S,k,M,q){return q&&(q.S&&g(q,A),S.state=function(){return g(A,{})}),M?(f[a]=S,k):S})(C,y,"global"in p?p.global:this==f,p.state)}function u(v){var p,d=v.length,w=this,y=0,A=w.i=w.j=0,C=w.S=[];for(d||(v=[d++]);y<x;)C[y]=y++;for(y=0;y<x;y++)C[y]=C[A=e&A+v[y%d]+(p=C[y])],C[A]=p;(w.g=function(S){for(var k,M=0,q=w.i,G=w.j,j=w.S;S--;)k=j[q=e&q+1],M=M*x+j[e&(j[q]=j[G=e&G+k])+(j[G]=k)];return w.i=q,w.j=G,M})(x)}function g(v,p){return p.i=v.i,p.j=v.j,p.S=v.S.slice(),p}function N(v,p){var d=[],w=typeof v,y;if(p&&w=="object")for(y in v)try{d.push(N(v[y],p-1))}catch{}return d.length?d:w=="string"?v:v+"\0"}function b(v,p){for(var d=v+"",w,y=0;y<d.length;)p[e&y]=e&(w^=p[e&y]*19)+d.charCodeAt(y++);return X(p)}function B(){try{var v;return n&&(v=n.randomBytes)?v=v(x):(v=new Uint8Array(x),(m.crypto||m.msCrypto).getRandomValues(v)),X(v)}catch{var p=m.navigator,d=p&&p.plugins;return[+new Date,m,d,m.screen,X(s)]}}function X(v){return String.fromCharCode.apply(0,v)}if(b(f.random(),s),h.exports){h.exports=i;try{n=require("crypto")}catch{}}else f["seed"+a]=i})(typeof self!="undefined"?self:_,[],Math)})(L);var wt=Q.exports,dt=U.exports,bt=Y.exports,At=K.exports,St=W.exports,Ct=J.exports,z=L.exports;z.alea=wt;z.xor128=dt;z.xorwow=bt;z.xorshift7=At;z.xor4096=St;z.tychei=Ct;var Nt=z;const V=h=>{const m=h.allegiance===O.Black||h.allegiance===O.White;let s=0;switch(h.piece){case null:s=1;break;case"N":case"B":s=3;break;case"R":s=5;break;case"Q":s=9;break}return m?s*2:s},Mt=h=>h.getSquares().reduce((s,f)=>{if(!f)return s;const x=V(f);return ft(f.allegiance)===h.activeColour?s+x:s-x},0),Z=(h,m,s=String(Math.random()))=>{if(m<=0)return null;const f=h.getValidMoves(),x=Nt(s),c=new Map;for(let o=0;o<f.length;o++){const e=f[o],n=h.clone();n.executeNode(e);let i=Mt(n);const u=Z(n,m-1,s);if(u&&(i-=u.score),e.kind==="game-over"&&(e.outcome==="draw"&&(i=Number.NEGATIVE_INFINITY),e.outcome==="white"&&n.activeColour==="white"&&(i=Number.POSITIVE_INFINITY),e.outcome==="black"&&n.activeColour==="black"&&(i=Number.POSITIVE_INFINITY)),e.kind==="move"){const N=n.getSquare(e.to),b=n.getSquare(e.to);(e.type==="allegiance"||e.type==="capture")&&(i+=V(N)),e.type==="promotion"&&(i+=V({allegiance:b.allegiance,piece:e.promotionTo})-V(b))}const g=c.get(i);c.set(i,g?[...g,o]:[o])}const l=[...c.entries()].sort(),[a,t]=l.at(-1),r=t.at(Math.floor(x()*t.length));return{score:a,index:r,seed:s}},Et=et({__name:"bot-game",setup(h){const m=nt(),s=rt(),f=H(()=>{const u=Array.isArray(m.params.state)?m.params.state[0]:m.params.state;return u?T.hexToUtf8(u):lt.VanillaDefault}),x=H(()=>{const u=Array.isArray(m.params.history)?m.params.history[0]:m.params.history;return u?T.hexToUtf8(u):""}),c=H(()=>{const u=new xt;return f.value&&u.importAFEN(f.value),x.value&&u.importMoveHistory(x.value),u}),l=gt(),a=u=>{const g=c.value.findMoveIndex(u);g!==-1&&(c.value.executeMoveIndex(g),l==null||l.playNode(u),s.push({path:`/play/bot/${T.utf8ToHex(c.value.toAFEN())}/${T.utf8ToHex(c.value.getMoveHistory())}`}))},{gameOver:t}=yt(c),r=ct(),o=vt(),e=ot(null),n=H(()=>c.value.activeColour!==e.value),i=()=>{const u=Z(c.value,3);!u||(c.value.executeMoveIndex(u.index),s.push({path:`/play/bot/${T.utf8ToHex(c.value.toAFEN())}/${T.utf8ToHex(c.value.getMoveHistory())}`}))};return it(n,u=>{if(!u)return;const g=setTimeout(()=>{i()},1);return()=>clearTimeout(g)}),at(()=>{e.value||(e.value=Math.random()>.5?"white":"black"),n.value&&i()}),(u,g)=>(P(),R(tt,{flat:"",class:"full-width"},{default:E(()=>[$(F,{horizontal:I(r).screen.gt.sm,class:D({"q-px-none":I(r).screen.lt.sm})},{default:E(()=>[$(F,{style:ut({width:`${I(o)}px`}),class:D({"q-px-none":I(r).screen.lt.sm})},{default:E(()=>[$(pt,{onExecuteNode:a,board:c.value,perspective:e.value||"white","play-as":["white","black"],width:I(o),"rounded-borders":I(r).screen.gt.xs},null,8,["board","perspective","width","rounded-borders"])]),_:1},8,["style","class"]),$(F,{class:"q-mb-md full-width"},{default:E(()=>[$(ht,{"move-history":c.value.getMoveHistoryAst(),"active-colour":c.value.activeColour,"own-colour":c.value.activeColour,afen:c.value.toAFEN()},null,8,["move-history","active-colour","own-colour","afen"])]),_:1})]),_:1},8,["horizontal","class"]),I(t)?(P(),R(mt,{key:0,node:I(t)},null,8,["node"])):st("",!0)]),_:1}))}});export{Et as default};
//# sourceMappingURL=bot-game.44f72bf8.js.map
