import{Q as B,a as i}from"./QCard.74c18b57.js";import{Q as x}from"./chess-piece.3af92ba3.js";import{b as I,a as k}from"./QList.885b2d0d.js";import{A as N,r as l,a as q,k as z,o as A,B as p,C as v,D as a,M as t,P as C,G as o,aj as E,H as M,I as G,u as D,O as Q}from"./index.602bb614.js";import{u as H}from"./use-quasar.4a23ba96.js";import{B as V,A as W}from"./board.83a5ff1c.js";import{u as L,_ as O,G as j,a as P}from"./board-size.19a9ac46.js";import{a as $,u as F}from"./board-audio.5e3fbaba.js";import"./use-dark.e969e9a4.js";import"./QScrollObserver.467c6677.js";import"./focus-manager.202af5b7.js";import"./QSeparator.556bfaa1.js";function T(){return new Worker("/assets/bot-worker.a64de57e.js",{type:"module"})}const le=N({__name:"bot-game",setup(U){const f=l(""),_=l(""),b=l("white"),y=l(0),n=l(),m=$(),s=l(),u=q(()=>new V(f.value||W.VanillaDefault,_.value)),{gameOver:c}=F(u),h=r=>{var w;const e=r.data;switch(e.type){case"board-update":f.value=e.afen,_.value=e.moveHistory,b.value=e.activeColour,y.value=e.boardScore;break;case"node-execution":m==null||m.playNode(e.node);break}e.type==="board-update"&&e.activeColour!==n.value&&!c.value&&((w=s.value)==null||w.postMessage({type:"bot-move"}))};z(()=>{s.value=new T,s.value.addEventListener("message",h),s.value.postMessage({type:"reset"}),n.value=Math.random()>.5?"white":"black"}),A(()=>{var r,e;(r=s.value)==null||r.removeEventListener("message",h),(e=s.value)==null||e.postMessage({type:"reset"})});const S=r=>{var e;(e=s.value)==null||e.postMessage({type:"execute-move-index",index:r})},d=H(),g=L();return(r,e)=>(p(),v(B,{flat:"",class:"full-width"},{default:a(()=>[n.value?(p(),v(i,{key:0,horizontal:t(d).screen.gt.sm,class:C({"q-px-none":t(d).screen.lt.sm})},{default:a(()=>[o(i,{style:E({width:`${t(g)}px`}),class:C({"q-px-none":t(d).screen.lt.sm})},{default:a(()=>[o(O,{onExecuteNodeIndex:S,board:u.value,perspective:n.value,"play-as":["white","black"],width:t(g),"rounded-borders":t(d).screen.gt.xs},null,8,["board","perspective","width","rounded-borders"])]),_:1},8,["style","class"]),o(i,{class:"q-mb-md full-width"},{default:a(()=>[o(j,{"move-history":u.value.getMoveHistoryAst(),"active-colour":b.value,"own-colour":n.value,afen:u.value.toAFEN(),"game-over":t(c)},{default:a(()=>[o(I,null,{default:a(()=>[o(k,{class:"q-mt-sm q-mb-sm"},{default:a(()=>[o(x,null,{default:a(()=>[M("Evaluation")]),_:1}),o(x,{caption:"",lines:"2"},{default:a(()=>[M(G(y.value),1)]),_:1})]),_:1}),o(k,{side:""},{default:a(()=>[o(D,{name:"exposure_plus_1"})]),_:1})]),_:1})]),_:1},8,["move-history","active-colour","own-colour","afen","game-over"])]),_:1})]),_:1},8,["horizontal","class"])):Q("",!0),t(c)?(p(),v(P,{key:1,node:t(c)},null,8,["node"])):Q("",!0)]),_:1}))}});export{le as default};
//# sourceMappingURL=bot-game.f5ce510f.js.map
