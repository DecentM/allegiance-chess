import{Q as i}from"./chess-piece.3f24ab6b.js";import{b as _,a as c}from"./QList.a95d107d.js";import{A as b,o as x,a as y,r as k,k as w,w as I,B as v,C as m,D as a,G as t,N as o,H as d,I as C,u as q,P as B}from"./index.0dab1eee.js";import{u as M}from"./use-quasar.520e2576.js";import{u as N,_ as Q,C as S,G as H,a as O}from"./board-worker.8292f654.js";import"./use-dark.17eafb98.js";import"./QCard.27897d44.js";import"./QScrollObserver.c950552a.js";import"./focus-manager.202af5b7.js";import"./QSeparator.9182f6a0.js";import"./notify.770fd796.js";import"./exports.8bff4ac7.js";const j=b({__name:"online-game",props:{connection:{}},setup(p){const n=p;x(()=>{n.connection.disconnect()});const f=M(),l=y(()=>n.connection.serverSide.value?n.connection.isHost.value?n.connection.serverSide.value:n.connection.serverSide.value==="white"?"black":"white":null),g=k([]),e=N({autoplayFor:g});w(()=>e.reset());const h=s=>{n.connection.sendMessage({type:"execute-node-index",value:s})};return I(n.connection.moveHistory,s=>{const u=s.at(-1);typeof u=="number"&&e.executeMoveIndex(u)}),(s,u)=>(v(),m(Q,null,{board:a(()=>{var r;return[t(S,{onExecuteNodeIndex:h,"model-value":o(e).afen.value,"valid-moves":o(e).validMoves.value,board:o(e),perspective:(r=l.value)!=null?r:"white","play-as":["white","black"],"rounded-borders":o(f).screen.gt.xs,"active-colour":o(e).activeColour.value,"check-moves":o(e).checkMoves.value,"en-passant-target":o(e).enPassantTarget.value,"move-history-ast":o(e).moveHistoryAst.value,squares:o(e).squares.value,loading:o(e).loading.value},null,8,["model-value","valid-moves","board","perspective","rounded-borders","active-colour","check-moves","en-passant-target","move-history-ast","squares","loading"])]}),sidebar:a(()=>{var r;return[t(H,{"move-history":o(e).moveHistoryAst.value,"active-colour":o(e).activeColour.value,"own-colour":(r=l.value)!=null?r:"white",afen:o(e).afen.value,"game-over":o(e).gameOver.value},{default:a(()=>[t(_,null,{default:a(()=>[t(c,{class:"q-mt-sm q-mb-sm"},{default:a(()=>[t(i,null,{default:a(()=>[d("Opening")]),_:1}),t(i,{caption:"",lines:"2"},{default:a(()=>[d(C(o(e).opening.value||"unknown"),1)]),_:1})]),_:1}),t(c,{side:""},{default:a(()=>[t(q,{name:"book"})]),_:1})]),_:1})]),_:1},8,["move-history","active-colour","own-colour","afen","game-over"])]}),default:a(()=>[o(e).gameOver.value?(v(),m(O,{key:0,node:o(e).gameOver.value},null,8,["node"])):B("",!0)]),_:1}))}});export{j as default};
//# sourceMappingURL=online-game.94350dc0.js.map
